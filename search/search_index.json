{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Presentation This site is part of the course \"Comparative Genomics, Molecular Phylogeny and Evolutionary Sequence Analysis,\" conducted by Prof. Jo\u00e3o Paulo M S Lima, from the Bioinformatics Multidisciplinary Environment - BioME of the Federal University of Rio Grande do Norte. Here is the material needed to follow the course and the practical tutorials and examples. Objectives Provide indispensable knowledge on the application of molecular phylogeny analysis and the first necessary steps for its proper use. Discuss the methods involved in the evolutionary analysis of biological sequences. Guide the use of computational tools used in molecular phylogeny analysis. Nature of the course Theoretical-practical course. The theory will be approached from remote meetings using Zoom. We are going to focus on the basic concepts of the area, contextualizing the use of models and methods more appropriate for specific data and analysis types. The practices will be the guided execution of programs and pipelines of analysis, based on example data sets. Program/Contents First day: Basic Concepts of Evolution of Biological Sequences. Choosing markers and assembly of datasets. Using Metadata. Multiple Sequence Alignment. Best Practices for Phylogeny. Tutorial 1. Cleaning and trimming multiple sequence alignments. Trimal demonstration. Getting information about sequences features from multiple alignments: Estimating sequence substitution saturation Tutorial 2. Codon usage, nucleotide frequency and other useful sequence features. Demonstration - MEGAX and DAMBE. Second day: Testing of substitutions models (Best-fit substitution models). Tutorial 3 - jModelTest \" Family of programs \". Phylogenetic Inferences - A Brief Theory: Distance Methods. Usage demonstration. Maximum Parsimony. Usage demonstration. Maximum Likelihood. Demonstration 4. Tutorial 4 - Using MEGA. Exploratory comparative genomics: Using TaxOnTree . Third day: Phylogenetic Inferences - A Brief Theory: Bayesian Inference. Tutorial 5 - Using BEAST. Principles of Phylodynamics: Tutorial 6 - BEAST+EBSP with Zika Virus' data. Additional Analysis: Test of Selection using MEGA. Gene Recombination Inference. Using DataMonkey tools Gene Inactivation Inference. Other activities Using Pseudochecker . Using IQ-Tree .","title":"Home"},{"location":"#presentation","text":"This site is part of the course \"Comparative Genomics, Molecular Phylogeny and Evolutionary Sequence Analysis,\" conducted by Prof. Jo\u00e3o Paulo M S Lima, from the Bioinformatics Multidisciplinary Environment - BioME of the Federal University of Rio Grande do Norte. Here is the material needed to follow the course and the practical tutorials and examples.","title":"Presentation"},{"location":"#objectives","text":"Provide indispensable knowledge on the application of molecular phylogeny analysis and the first necessary steps for its proper use. Discuss the methods involved in the evolutionary analysis of biological sequences. Guide the use of computational tools used in molecular phylogeny analysis.","title":"Objectives"},{"location":"#nature-of-the-course","text":"Theoretical-practical course. The theory will be approached from remote meetings using Zoom. We are going to focus on the basic concepts of the area, contextualizing the use of models and methods more appropriate for specific data and analysis types. The practices will be the guided execution of programs and pipelines of analysis, based on example data sets.","title":"Nature of the course"},{"location":"#programcontents","text":"","title":"Program/Contents"},{"location":"#first-day","text":"Basic Concepts of Evolution of Biological Sequences. Choosing markers and assembly of datasets. Using Metadata. Multiple Sequence Alignment. Best Practices for Phylogeny. Tutorial 1. Cleaning and trimming multiple sequence alignments. Trimal demonstration. Getting information about sequences features from multiple alignments: Estimating sequence substitution saturation Tutorial 2. Codon usage, nucleotide frequency and other useful sequence features. Demonstration - MEGAX and DAMBE.","title":"First day:"},{"location":"#second-day","text":"Testing of substitutions models (Best-fit substitution models). Tutorial 3 - jModelTest \" Family of programs \". Phylogenetic Inferences - A Brief Theory: Distance Methods. Usage demonstration. Maximum Parsimony. Usage demonstration. Maximum Likelihood. Demonstration 4. Tutorial 4 - Using MEGA. Exploratory comparative genomics: Using TaxOnTree .","title":"Second day:"},{"location":"#third-day","text":"Phylogenetic Inferences - A Brief Theory: Bayesian Inference. Tutorial 5 - Using BEAST. Principles of Phylodynamics: Tutorial 6 - BEAST+EBSP with Zika Virus' data. Additional Analysis: Test of Selection using MEGA. Gene Recombination Inference. Using DataMonkey tools Gene Inactivation Inference.","title":"Third day:"},{"location":"#other-activities","text":"Using Pseudochecker . Using IQ-Tree .","title":"Other activities"},{"location":"1st_BEAST/","text":"First steps in BEAST Aims Geral Learn the first steps to perform an analysis with the BEAST phylogenetic analysis package. Specific Importing an alignment file. Choice of model Learn how to build the input XML files using BEAUti. Run BEAST for the first time. First steps of analyzing the output BEAST files. Remarks: This tutorial has been adapted to BEAST2 from First tutorial available in the BEAST online community, unique and exclusively for educational purposes . For any purpose, the original tutorial is the one to be cited or referenced. Part of this tutorial can also be run with BEAST1.x. Differences between BEAST2 and BEAST1.x features and applications can be found HERE . This tutorial requires a basic knowledge of molecular phylogeny concepts and some terminologies used in the field. Citation of the BEAST Program: Bouckaert R, Heled J, K\u00fchnert D, et al. BEAST 2: A Software Platform for Bayesian Evolutionary Analysis. Prlic A, ed. PLoS Comput Biol. 2014;10(4):e1003537-6. doi:10.1371/journal.pcbi.1003537. BEAST1.x and BEAST2 are now independent projects. Read carefully the link above listed with the differences in the functions/analysis from both programs. Importing the alignment The initial working data group will be an alignment of mitochondrial tRNA sequences of 6 primates (5 monkeys and 1 gibbon as outgroup), apes.nex . The nexus file is very common in phylogeny and several multiple sequence alignment programs have the ability to export the alignment in this format. The nexus file is represented below (with truncated lines): #NEXUS BEGIN DATA; DIMENSIONS NTAX=6 NCHAR=768; FORMAT MISSING=? GAP=- DATATYPE=DNA; MATRIX human AGAAATATGTCTGATAAAAGAGTTACTTTGATAGAGTAAATAATAGGAGC... chimp AGAAATATGTCTGATAAAAGAATTACTTTGATAGAGTAAATAATAGGAGT... bonobo AGAAATATGTCTGATAAAAGAATTACTTTGATAGAGTAAATAATAGGAGT... gorilla AGAAATATGTCTGATAAAAGAGTTACTTTGATAGAGTAAATAATAGAGGT... orangutan AGAAATATGTCTGACAAAAGAGTTACTTTGATAGAGTAAAAAATAGAGGT... siamang AGAAATACGTCTGACGAAAGAGTTACTTTGATAGAGTAAATAACAGGGGT... ; END; To use this alignment in analysis with BEAST, we will have to import it with the BEAUti tool. It is an interactive graphical application to outline your analysis and generate the control file (an XML file) used by BEAST to perform the analysis. This is the BEAUti icon. Just double-click it to execute it. Once BEAUti is executed, a window similar to the one below should appear: To load the nexus alignment file, you have two options: Click on \"File\" and then \"Import Alignment\". Click on the + symbol in the bottom left corner of the screen. BEAUti can also import fasta files (as long as the sequences are aligned) or BEAST XML files. However, in the latter case, only the data will be imported, not the race parameters and settings. Once loaded, the alignment will be displayed in table format in the main window: By double-clicking on the table row, the alignment can be viewed (although not good): At the top of the main window, a series of \"tabs\" can be observed: Each of these tabs has settings and options. In general, you should always work with them from left to right. However, not all guides will be relevant for all analyses. After the Partitions tab, you can go to the tab called Tip Dates. Setting the Tip Dates (when applicable) The Tip Dates tab is used to put dates for each of the rates in your analysis. In it, you will see a table with all the taxonomic groups you are analyzing. Taxon dates ( Tip dates ) are only important in some cases, for example when you are working with rapidly evolving viruses or DNA from old samples or fossils. In the case of this analysis of primates that we are performing in this tutorial, the tree represents millions of years of evolution, so the dates can be assumed to be zero. This is the pattern - all rates have a date of zero, and the use of the Tip Dates tab is not selected. Setting up the evolutionary model In the Site Model tab you can adjust the molecular evolution model (nucleotide and amino acid substitution model) to the sequence data you have loaded (apes.nex). The exact options will appear depending on the type of data you have loaded (nucleotides, amino acids or other form of data). The options that will appear after the ``apes.nex'' alignment data has been loaded are as follows: This tutorial assumes that you have read or studied the different evolutionary models available. In this analysis, we will use the HKY model. In previous versions of BEAST (1.7 or 1.8) it is easier to choose the codon positions to run the analysis (an alignment based on codons is required). If you need partition analysis, you have to use these versions. However, these data are from mitochondrial tRNAs, so this option would not apply. Configuring the Molecular Clock Model ( Molecular Clock ) In the next tab, Clock Model , we will determine the molecular clock model that will be used in the analysis. Unlike many other phylogenetic analysis programs, BEAST exclusively uses molecular clock models so that trees have a time scale (an inferred root and a direction in time). The simplest model is the \" Strict clock \" or restricted clock pattern. Such model assumes that all branches in the tree have the same rate of evolution. Other molecular clock models relax these assumptions in various ways, and other advanced tutorials can be used to verify their application. Select Strict Clock and switch to the Priors tab. Setting the priors It is on this panel that the priors of Bayesian analysis will be determined. In the first checkbox, you can put the model that will provide a priori in the tree for the MCMC race. The priori of the tree ( Tree Prior ) has many possibilities, usually divided into coalescing models ( Coalescent ), which are generally suitable for populations, and speciation models ( Speciation ), which as the name suggests are directed to species-level data. As the alignment we have is of several species, we will select the model of Yule , which is the simplest speciation model, where it is assumed that each lineage presented speciation at a fixed rate. For each priori model of the tree, the following specific parameters appear in the window. Each parameter in the model has operators, which specify how the parameters change as the MCMC rotates. For the Yule model, only two parameters are needed: kappa , which means the tendency of transitions-transversions in the HKY model; and the birth rate of new species birthRate . BEAST reasonably maintains the standard values for the priors of each model. Selecting the priors is one aspect of the BEAST analysis that should be taken most seriously. Only modify these parameters if you are sure of what you are doing, with specific knowledge of each one. In the rest of this tutorial, we will use these default values, so leave them as they are and move to the MCMC tab. Setting the MCMC run Options On this tab, we will have the settings to run the Bayesian analysis by BEAST. First we have the length of the chain (or referred to as the number of generations). This is the number of steps that the MCMC will do in the chain before finishing the process. How long it should depend on the size of the data set, the complexity of the model, and the quality of the required response. In this case, the default value is entirely arbitrary and must be adjusted according to the size of the data set that will be analyzed. To verify that the string size is adequate, the resulting log file ( log file ) can be analyzed using the Tracer program (we will verify this later). The goal of selecting an adequate chain size is to achieve a reasonable ( ESS - Effective Sample Size ). Ways to achieve an adequate ESS can be checked in other [BEAST community] tutorials (beast.community) . The following options specify how much such parameters should be logged in the log file ( tracelog ) and shown on the screen ( screenlog ). For the tracelog , the value must be relative to the chain size's total value. Performing a very frequent sampling (value logging) will result in huge files with little extra benefit in terms of accuracy. On the other hand, sampling infrequently will result in a log file without sufficient information about the parameter distributions. Typically, 10,000 samplings is an adequate number, and to store this, just put a number that is the chain size / 10,000. The other options can be left at the default values (stressing again that in BEAST, the defaults are reasonable). For this data set (which is quite small), we will start the analysis with a chain size of 1,000,000, as this value will run very quickly on most computers today. Therefore, put the frequency record (sampling) in the log file for 100. The screen output is simply to monitor the progress of the BEAST race, so any value can be placed (however, if you choose a too small value, the amount of information that will appear on the screen may slow down the program terminal). The frequency of screen log sampling and trace log can be different. In this case, our analysis will run very fast, so sampling the screen log for every 100 steps will cause a quick movement on the screen due to a large amount of information. For the tree log option, leave the same sampling number in trace log . Saving and uploading the BEAUti files By selecting Save from the File menu, a file in BEAUti format will be saved. Note that this is not the format that BEAST \"understands\" - BEAUti will only reopen it. This way, the settings and data can be saved and loaded later. Save the BEAUti files with the extension .beauti . So as the BEAUti files cannot be read and \"understood\" by BEAST, you cannot open the BEAST XML files back directly in BEAUti. If necessary, they can be imported in the same way as FASTA or NEXUS files. The sequence data, the Tip Dates and other information will be imported. Generating the BEAST XML file The XML BEAST file can now be created. Select Save as... from the File menu and save it with an appropriate name. Do not forget to add the .xml extension when saving. On Computers Now the file is ready to be run with BEAST. Running BEAST Turn BEAST2 by clicking the following icon: The following window will appear: From now on, all you need to do is click on Choose File... , select the XML file you saved in the previous steps and press Run . To speed up analysis with larger data sets and/or larger MCMC chain sizes, installing the BEAGLE library is strongly recommended, especially if you have a video card with CUDA (GPU) support. In BEAST1.x, the BEAGLE library can be run directly from this window. In version 2, it recommends installing JAVA JDK and running BEAST2 from the terminal command line (on computers with Unix-based systems). The beagle_SSE instruction setting also dramatically speeds up the analysis of computers with newer processors. An example of a general command to run BEAST2 from a terminal is: /bin/beast -beagle_CPU -beagle_SSE -threads 4 -instances 4 -overwrite file_name.xml The window to run on BEAST1.x versions is very similar. When running, BEAST (in any version) will load the XML file, configure the parsing and run it without additional interaction. It starts with the title and credits of the software. You will see the output screen, with various information, similar to the one below: A little lower, in this same window you will be able to see the citations of the models used and the MCMC chain screen log, with an estimate of the time of the analysis (time unit / Millions of samples): And at the end, a diagnosis of the adequacy of the analysis parameters to the data group: To learn more about the changes in these parameters, look for the BEAST documentation. Only change them with absolute certainty of what you are doing.* After the race, BEAST generates the following files that you will use later: File .log (with the Bayesian MCMC analysis log). File .trees (with all trees generated and logged). Analyzing the log file with TRACER Tracer](http://tree.bio.ed.ac.uk/software/tracer/) is a program to analyze the files generated by Bayesian MCMC races (that is, the continuous values of the parameters sampled from the chain. The analysis with Tracer is very detailed. For simplicity purposes in this tutorial, we will comment only on the actual sample size parameters to check if there is a greater need for sampling or larger chain size. Run TRACER by clicking on the icon: When opened, Tracer will show the following window: To open the MCMC trace log file (file .log ), click the + symbol just below Trace Files: (indicated by the arrow on the figure above). After this step, a window like this should be displayed: Note that the Arrow 1 shown in the figure above is indicating that Tracer assigns 10% to Burn-In . This is the number of steps at the beginning of the chain that is discarded from the analysis, which tends to present a greater variation in the parameters. The discard or burn-in of 10% of the total chain size is the recommended one. However, this can be changed. This value can be increased in races with larger MCMC chain sizes. docs/MEGAX_ENG.md Observe the parameters highlighted by the red frame. In all, the values in the ESS column ( Effective Sample Size ) must be in black. This demonstrates that the values are suitable for analysis. When they are not, they are marked in the colors orange , which indicates that they are partially adequate, or red , which indicates that they are not adequate. The parameters that should be analyzed initially are posterior , likelihood , and the model's statistical parameters as prior or YuleModel . To match the parameter statistics that the ESS is marked in red, you can increase the size of the string, and depending on the parameter, changes in priors in the XML file with BEAUti should be performed. The analysis of these parameters and the BEAST diagnostic indications at the end of each race are strongly recommended. Click on Arrow 2 and the Trace of the race can be observed. The gray part in Trace demonstrates exactly the Burn-In employed in the analysis, as can be seen in the figure below: This same burn-in will also be used when summarizing the trees of Bayesian analysis. Finally, select the statistics of the posterior and likelihood parameters (using the ctrl key on your keyboard) and click on Arrow 3 . Tracer will return you a graph of the point distribution of the 2 parameters, similar to the figure below: For further details on the analysis with Tracer and its other functions, in-depth readings on Bayesian Inference, the Tracer manual/readme and the BEAST community are recommended. Summarization and Viewing of Generated Trees Now we will work with the .trees file, generated by BEAST. As described previously, this file has each tree generated and recorded by MCMC analysis. Since we had a chain size of 1,000,000 and asked to make records every 100 (the same as trace log ), we will have a file with 10,000 trees. We have to summarize all these trees, in one, with the a posteriori (PP) probability values in each node of the tree. For that, we will use a program provided with the BEAST, called TreeAnnotator. To run it, click on its respective icon: A window similar to the one below will appear: In the Burnin percentage box, you will put the burn-in percentage of this analysis, that is, the first generated trees that will be discarded from the analysis because they are at the beginning of the chain. The Posterior probability limit option serves to avoid solving tree nodes below the PP limit entered in this field. For example, if you place the limit of 50, nodes with less than 50 PP will not be solved. In the options Target tree type and Node heights choose the options demonstrated in the picture above, from Maximum clade credibility tree and *Common Ancestor heights , respectively. In the Input Tree File field, you will click on Choose File... and add the .trees generated in the analysis. And in the Output File field, you will also click on Choose File... , in which case, you will name the file and insert it in the folder of your choice. Do not forget to put the extension .tree at the end of the file name so that the tree visualization programs will more easily recognize it. A recommended program for tree visualization is the FigTree program, which can be obtained HERE . The file .trees can also be viewed with the DensiTree program. This program makes a schematic representation with all the trees, facilitating the analysis of inconsistencies. DensiTree can be executed by the icon:","title":"Using BEAST"},{"location":"1st_BEAST/#first-steps-in-beast","text":"","title":"First steps in BEAST"},{"location":"1st_BEAST/#aims","text":"","title":"Aims"},{"location":"1st_BEAST/#geral","text":"Learn the first steps to perform an analysis with the BEAST phylogenetic analysis package.","title":"Geral"},{"location":"1st_BEAST/#specific","text":"Importing an alignment file. Choice of model Learn how to build the input XML files using BEAUti. Run BEAST for the first time. First steps of analyzing the output BEAST files.","title":"Specific"},{"location":"1st_BEAST/#remarks","text":"This tutorial has been adapted to BEAST2 from First tutorial available in the BEAST online community, unique and exclusively for educational purposes . For any purpose, the original tutorial is the one to be cited or referenced. Part of this tutorial can also be run with BEAST1.x. Differences between BEAST2 and BEAST1.x features and applications can be found HERE . This tutorial requires a basic knowledge of molecular phylogeny concepts and some terminologies used in the field. Citation of the BEAST Program: Bouckaert R, Heled J, K\u00fchnert D, et al. BEAST 2: A Software Platform for Bayesian Evolutionary Analysis. Prlic A, ed. PLoS Comput Biol. 2014;10(4):e1003537-6. doi:10.1371/journal.pcbi.1003537. BEAST1.x and BEAST2 are now independent projects. Read carefully the link above listed with the differences in the functions/analysis from both programs.","title":"Remarks:"},{"location":"1st_BEAST/#importing-the-alignment","text":"The initial working data group will be an alignment of mitochondrial tRNA sequences of 6 primates (5 monkeys and 1 gibbon as outgroup), apes.nex . The nexus file is very common in phylogeny and several multiple sequence alignment programs have the ability to export the alignment in this format. The nexus file is represented below (with truncated lines): #NEXUS BEGIN DATA; DIMENSIONS NTAX=6 NCHAR=768; FORMAT MISSING=? GAP=- DATATYPE=DNA; MATRIX human AGAAATATGTCTGATAAAAGAGTTACTTTGATAGAGTAAATAATAGGAGC... chimp AGAAATATGTCTGATAAAAGAATTACTTTGATAGAGTAAATAATAGGAGT... bonobo AGAAATATGTCTGATAAAAGAATTACTTTGATAGAGTAAATAATAGGAGT... gorilla AGAAATATGTCTGATAAAAGAGTTACTTTGATAGAGTAAATAATAGAGGT... orangutan AGAAATATGTCTGACAAAAGAGTTACTTTGATAGAGTAAAAAATAGAGGT... siamang AGAAATACGTCTGACGAAAGAGTTACTTTGATAGAGTAAATAACAGGGGT... ; END; To use this alignment in analysis with BEAST, we will have to import it with the BEAUti tool. It is an interactive graphical application to outline your analysis and generate the control file (an XML file) used by BEAST to perform the analysis. This is the BEAUti icon. Just double-click it to execute it. Once BEAUti is executed, a window similar to the one below should appear: To load the nexus alignment file, you have two options: Click on \"File\" and then \"Import Alignment\". Click on the + symbol in the bottom left corner of the screen. BEAUti can also import fasta files (as long as the sequences are aligned) or BEAST XML files. However, in the latter case, only the data will be imported, not the race parameters and settings. Once loaded, the alignment will be displayed in table format in the main window: By double-clicking on the table row, the alignment can be viewed (although not good): At the top of the main window, a series of \"tabs\" can be observed: Each of these tabs has settings and options. In general, you should always work with them from left to right. However, not all guides will be relevant for all analyses. After the Partitions tab, you can go to the tab called Tip Dates.","title":"Importing the alignment"},{"location":"1st_BEAST/#setting-the-tip-dates-when-applicable","text":"The Tip Dates tab is used to put dates for each of the rates in your analysis. In it, you will see a table with all the taxonomic groups you are analyzing. Taxon dates ( Tip dates ) are only important in some cases, for example when you are working with rapidly evolving viruses or DNA from old samples or fossils. In the case of this analysis of primates that we are performing in this tutorial, the tree represents millions of years of evolution, so the dates can be assumed to be zero. This is the pattern - all rates have a date of zero, and the use of the Tip Dates tab is not selected.","title":"Setting the Tip Dates (when applicable)"},{"location":"1st_BEAST/#setting-up-the-evolutionary-model","text":"In the Site Model tab you can adjust the molecular evolution model (nucleotide and amino acid substitution model) to the sequence data you have loaded (apes.nex). The exact options will appear depending on the type of data you have loaded (nucleotides, amino acids or other form of data). The options that will appear after the ``apes.nex'' alignment data has been loaded are as follows: This tutorial assumes that you have read or studied the different evolutionary models available. In this analysis, we will use the HKY model. In previous versions of BEAST (1.7 or 1.8) it is easier to choose the codon positions to run the analysis (an alignment based on codons is required). If you need partition analysis, you have to use these versions. However, these data are from mitochondrial tRNAs, so this option would not apply.","title":"Setting up the evolutionary model"},{"location":"1st_BEAST/#configuring-the-molecular-clock-model-molecular-clock","text":"In the next tab, Clock Model , we will determine the molecular clock model that will be used in the analysis. Unlike many other phylogenetic analysis programs, BEAST exclusively uses molecular clock models so that trees have a time scale (an inferred root and a direction in time). The simplest model is the \" Strict clock \" or restricted clock pattern. Such model assumes that all branches in the tree have the same rate of evolution. Other molecular clock models relax these assumptions in various ways, and other advanced tutorials can be used to verify their application. Select Strict Clock and switch to the Priors tab.","title":"Configuring the Molecular Clock Model (Molecular Clock)"},{"location":"1st_BEAST/#setting-the-priors","text":"It is on this panel that the priors of Bayesian analysis will be determined. In the first checkbox, you can put the model that will provide a priori in the tree for the MCMC race. The priori of the tree ( Tree Prior ) has many possibilities, usually divided into coalescing models ( Coalescent ), which are generally suitable for populations, and speciation models ( Speciation ), which as the name suggests are directed to species-level data. As the alignment we have is of several species, we will select the model of Yule , which is the simplest speciation model, where it is assumed that each lineage presented speciation at a fixed rate. For each priori model of the tree, the following specific parameters appear in the window. Each parameter in the model has operators, which specify how the parameters change as the MCMC rotates. For the Yule model, only two parameters are needed: kappa , which means the tendency of transitions-transversions in the HKY model; and the birth rate of new species birthRate . BEAST reasonably maintains the standard values for the priors of each model. Selecting the priors is one aspect of the BEAST analysis that should be taken most seriously. Only modify these parameters if you are sure of what you are doing, with specific knowledge of each one. In the rest of this tutorial, we will use these default values, so leave them as they are and move to the MCMC tab.","title":"Setting the priors"},{"location":"1st_BEAST/#setting-the-mcmc-run-options","text":"On this tab, we will have the settings to run the Bayesian analysis by BEAST. First we have the length of the chain (or referred to as the number of generations). This is the number of steps that the MCMC will do in the chain before finishing the process. How long it should depend on the size of the data set, the complexity of the model, and the quality of the required response. In this case, the default value is entirely arbitrary and must be adjusted according to the size of the data set that will be analyzed. To verify that the string size is adequate, the resulting log file ( log file ) can be analyzed using the Tracer program (we will verify this later). The goal of selecting an adequate chain size is to achieve a reasonable ( ESS - Effective Sample Size ). Ways to achieve an adequate ESS can be checked in other [BEAST community] tutorials (beast.community) . The following options specify how much such parameters should be logged in the log file ( tracelog ) and shown on the screen ( screenlog ). For the tracelog , the value must be relative to the chain size's total value. Performing a very frequent sampling (value logging) will result in huge files with little extra benefit in terms of accuracy. On the other hand, sampling infrequently will result in a log file without sufficient information about the parameter distributions. Typically, 10,000 samplings is an adequate number, and to store this, just put a number that is the chain size / 10,000. The other options can be left at the default values (stressing again that in BEAST, the defaults are reasonable). For this data set (which is quite small), we will start the analysis with a chain size of 1,000,000, as this value will run very quickly on most computers today. Therefore, put the frequency record (sampling) in the log file for 100. The screen output is simply to monitor the progress of the BEAST race, so any value can be placed (however, if you choose a too small value, the amount of information that will appear on the screen may slow down the program terminal). The frequency of screen log sampling and trace log can be different. In this case, our analysis will run very fast, so sampling the screen log for every 100 steps will cause a quick movement on the screen due to a large amount of information. For the tree log option, leave the same sampling number in trace log .","title":"Setting the MCMC run Options"},{"location":"1st_BEAST/#saving-and-uploading-the-beauti-files","text":"By selecting Save from the File menu, a file in BEAUti format will be saved. Note that this is not the format that BEAST \"understands\" - BEAUti will only reopen it. This way, the settings and data can be saved and loaded later. Save the BEAUti files with the extension .beauti . So as the BEAUti files cannot be read and \"understood\" by BEAST, you cannot open the BEAST XML files back directly in BEAUti. If necessary, they can be imported in the same way as FASTA or NEXUS files. The sequence data, the Tip Dates and other information will be imported.","title":"Saving and uploading the BEAUti files"},{"location":"1st_BEAST/#generating-the-beast-xml-file","text":"The XML BEAST file can now be created. Select Save as... from the File menu and save it with an appropriate name. Do not forget to add the .xml extension when saving. On Computers Now the file is ready to be run with BEAST.","title":"Generating the BEAST XML file"},{"location":"1st_BEAST/#running-beast","text":"Turn BEAST2 by clicking the following icon: The following window will appear: From now on, all you need to do is click on Choose File... , select the XML file you saved in the previous steps and press Run . To speed up analysis with larger data sets and/or larger MCMC chain sizes, installing the BEAGLE library is strongly recommended, especially if you have a video card with CUDA (GPU) support. In BEAST1.x, the BEAGLE library can be run directly from this window. In version 2, it recommends installing JAVA JDK and running BEAST2 from the terminal command line (on computers with Unix-based systems). The beagle_SSE instruction setting also dramatically speeds up the analysis of computers with newer processors. An example of a general command to run BEAST2 from a terminal is: /bin/beast -beagle_CPU -beagle_SSE -threads 4 -instances 4 -overwrite file_name.xml The window to run on BEAST1.x versions is very similar. When running, BEAST (in any version) will load the XML file, configure the parsing and run it without additional interaction. It starts with the title and credits of the software. You will see the output screen, with various information, similar to the one below: A little lower, in this same window you will be able to see the citations of the models used and the MCMC chain screen log, with an estimate of the time of the analysis (time unit / Millions of samples): And at the end, a diagnosis of the adequacy of the analysis parameters to the data group: To learn more about the changes in these parameters, look for the BEAST documentation. Only change them with absolute certainty of what you are doing.* After the race, BEAST generates the following files that you will use later: File .log (with the Bayesian MCMC analysis log). File .trees (with all trees generated and logged).","title":"Running BEAST"},{"location":"1st_BEAST/#analyzing-the-log-file-with-tracer","text":"Tracer](http://tree.bio.ed.ac.uk/software/tracer/) is a program to analyze the files generated by Bayesian MCMC races (that is, the continuous values of the parameters sampled from the chain. The analysis with Tracer is very detailed. For simplicity purposes in this tutorial, we will comment only on the actual sample size parameters to check if there is a greater need for sampling or larger chain size. Run TRACER by clicking on the icon: When opened, Tracer will show the following window: To open the MCMC trace log file (file .log ), click the + symbol just below Trace Files: (indicated by the arrow on the figure above). After this step, a window like this should be displayed: Note that the Arrow 1 shown in the figure above is indicating that Tracer assigns 10% to Burn-In . This is the number of steps at the beginning of the chain that is discarded from the analysis, which tends to present a greater variation in the parameters. The discard or burn-in of 10% of the total chain size is the recommended one. However, this can be changed. This value can be increased in races with larger MCMC chain sizes. docs/MEGAX_ENG.md Observe the parameters highlighted by the red frame. In all, the values in the ESS column ( Effective Sample Size ) must be in black. This demonstrates that the values are suitable for analysis. When they are not, they are marked in the colors orange , which indicates that they are partially adequate, or red , which indicates that they are not adequate. The parameters that should be analyzed initially are posterior , likelihood , and the model's statistical parameters as prior or YuleModel . To match the parameter statistics that the ESS is marked in red, you can increase the size of the string, and depending on the parameter, changes in priors in the XML file with BEAUti should be performed. The analysis of these parameters and the BEAST diagnostic indications at the end of each race are strongly recommended. Click on Arrow 2 and the Trace of the race can be observed. The gray part in Trace demonstrates exactly the Burn-In employed in the analysis, as can be seen in the figure below: This same burn-in will also be used when summarizing the trees of Bayesian analysis. Finally, select the statistics of the posterior and likelihood parameters (using the ctrl key on your keyboard) and click on Arrow 3 . Tracer will return you a graph of the point distribution of the 2 parameters, similar to the figure below: For further details on the analysis with Tracer and its other functions, in-depth readings on Bayesian Inference, the Tracer manual/readme and the BEAST community are recommended.","title":"Analyzing the log file with TRACER"},{"location":"1st_BEAST/#summarization-and-viewing-of-generated-trees","text":"Now we will work with the .trees file, generated by BEAST. As described previously, this file has each tree generated and recorded by MCMC analysis. Since we had a chain size of 1,000,000 and asked to make records every 100 (the same as trace log ), we will have a file with 10,000 trees. We have to summarize all these trees, in one, with the a posteriori (PP) probability values in each node of the tree. For that, we will use a program provided with the BEAST, called TreeAnnotator. To run it, click on its respective icon: A window similar to the one below will appear: In the Burnin percentage box, you will put the burn-in percentage of this analysis, that is, the first generated trees that will be discarded from the analysis because they are at the beginning of the chain. The Posterior probability limit option serves to avoid solving tree nodes below the PP limit entered in this field. For example, if you place the limit of 50, nodes with less than 50 PP will not be solved. In the options Target tree type and Node heights choose the options demonstrated in the picture above, from Maximum clade credibility tree and *Common Ancestor heights , respectively. In the Input Tree File field, you will click on Choose File... and add the .trees generated in the analysis. And in the Output File field, you will also click on Choose File... , in which case, you will name the file and insert it in the folder of your choice. Do not forget to put the extension .tree at the end of the file name so that the tree visualization programs will more easily recognize it. A recommended program for tree visualization is the FigTree program, which can be obtained HERE . The file .trees can also be viewed with the DensiTree program. This program makes a schematic representation with all the trees, facilitating the analysis of inconsistencies. DensiTree can be executed by the icon:","title":"Summarization and Viewing of Generated Trees"},{"location":"BEAST%2BEBSP_ENG/","text":"Phylogenetics analysis with Extended Bayesian Skyline Plots (EBSP) using BEAST Diego Gomes Teixeira (Ph.D.) and Jo\u00e3o Paulo M S Lima (Ph.D., Associate Professor) Bioinformatics Multidisciplinary Environment - BioME , Universidade Federal do Rio Grande do Norte. Introduction BEAST is a framework that uses an evolutionary approach based on a Bayesian model, which involves a wide range of analyses, resulting in the inference of one or more phylogenies or family trees. It also includes traditional phylogenies, phylodynamics, and phylogeographic inferences, as well as coalescence analysis of the evolutionary history of a population, usually obtained from a single analysis ( Drummond et al., 2005 ; Bouckaert et al., 2014 ). The demographic history of a population leaves a signature on the genome of current representatives. The reconstruction of this history allows us to gain insights into various evolutionary processes involving population genetics, such as tracing the transmission and spread of a virus. The method for estimating population history from DNA or AA sequences depends only on the coalescing events' time and not exactly on the genealogical relationships between the sequences. For example, coalescence events occurring in rapid succession are indicative of a small gene population size ( Ho; Shapiro, 2011 ). This tutorial will guide you through a phylogenetic analysis of an alignment of ZIKA virus sequences, sampled during the outbreak period in South America. This tutorial is an adaptation of the study conducted by FARIA et al. (2016) which investigated the approximate date of introduction of the virus in the Americas by identifying a possible common ancestor among American and Asian isolates. The aim is to reproduce the results obtained in this study, with a small additional population analysis through an Extended Bayesian Skyline Plot (EBSP) . BEAUTi Loading the NEXUS file To load the alignment, select the \" Import Alignment \" option from the \" File \" menu. The file Zika.nexus_Tutorial can be downloaded HERE and contains an alignment of 23 Zika Virus sequences. Adding the sampling date of the sequences In the top menu, select the Tip Dates tab and then check the Use tip date box. You will have the option to manually add each of the dates in the Date field, or you can upload a pre-assembled file containing the list of sequence names and the date, separated by a tab. In this example, we will use this list, clicking on the Guess button and then selecting the read from file field. Then, load the file Tutorial_ZIKA_tips.dat . Selecting the model In the top menu, select the tab Site Model and the field Subset Model change to the option GTR . Configuring the Priors In the Priors tab at Tree.t:Tutorial_ZIKA select the Coalescent Extended Bayesian Skyline option. Then click the + and select the option MRCA Prior . In the box that will appear, set the name of the taxon you want to work in the box Taxon set label . In this example, we will give the name of taxon A for the taxon that contains the sequences from South America plus the sequence from French Polynesia, and taxon B for the sequences from South America only. Configuring discrete features Back to the Partitions tab, let us click the + button located at the bottom of the BEAUTi window and select the option Add Discrete Trait . In the resulting box, we will set the name Locals in the box Trait Name . The next window will ask for the Trait name for each sequence. In that option, we will put the country of origin of each of the samples. Again we have the option to manually put the country name of one in one or to load a tabulated file containing the sequence name and the country name. In the Guess tab we will select the option Read from file and load the file Tutorial_ZIKA_locals.dat Configuring the MCMC In the MCMC tab we will set the Chain Length to 50,000,000 and change the values of Log Every in the boxes tracelog , treelog.t:Tutorial_ZIKA , treeWithTraitLogger.Locals and EBSPLogger to 5,000. Depending on your computer, this chain size can be considerable, and the program will take a long time running. However, it is necessary for EBSP. If you cannot run it, use the files already run at the end of this tutorial. After this step, go to File > Save and save the .xml file. BEAST Before running BEAST2, we have to install some additional extensions to perform these analyses. We will discuss these steps in a synchronous meeting. In the BEAST window, in the BEAST XML FILE field, we will load the .xml file created by BEAUTi and click Run. Tree Annotator At this stage, we will discard the first trees generated by BEAST from the MCMC. In the Burnin percentage box, we will put for the program to remove 10% of the initial trees. In the Node heights option, we will select the Median heights option, and then we will load the BEAST output, the Locals_tree_with_trait.trees , in the Input Tree File field, and define the name of the output file in the Output File option. FigTree In FigTree, load the file Local_tree_with_trait.tree , then adjust the branches. TRACER In the Tracer program, we will load the BEAST log file to access some information from the analysis. Clicking on the + we will load the zika_tutorial.log file. Then, we will select, in the Traces tab, the variables mrcatime(A) and mrcatime(B) . Observe the results. Constructing the EBSP Plot Open RStudio (or other R environment) and enter the following code: plotEBSP(\u201c/File_Folder/EBSP.log\", useHPD=FALSE, log=\"y\", xlim=c(0,5)) Remember to switch the File_Folder to the location where you saved the EBSP.log file. Compare the graph to the tree. Using the package EBSPAnalyser The EBSPAnalyser package produces a log file with columns time, mean, median, 95% upper and lower, which you can import in a spreadsheet or to your favorite plot software and use to draw a graph. To run in Linux/MacOS, open a terminal window and use the follow command: java -cp $(dir)/beast.jar beast.app.tools.EBSPAnalyser where $(dir) points to the directory where beast.jar is located. A window pops up where you specify the EBSP.log file and some other settings. Retrieved and adapted from Beast2/EBSPAnalyzer . Files generated after the BEAST execution The files generated from the above steps are available at the link below: Tutorial Zika Filogenia.zip References Bouckaert, R. et al. BEAST 2: A Software Platform for Bayesian Evolutionary Analysis. PLoS Computational Biology, v. 10, n. 4, p. e1003537, 10 abr. 2014. Drummond, A. J. et al. Bayesian coalescent inference of past population dynamics from molecular sequences. Molecular Biology and Evolution, v. 22, p. 1185\u20131192, 2005. Faria, N. R. et al. Zika virus in the Americas: Early epidemiological and genetic findings. Science (New York, N.Y.), v. 5036, n. March, p. aaf5036, 2016. Ho, S. Y. W.; Shapiro, B. Skyline-plot methods for estimating demographic history from nucleotide sequences. Molecular Ecology Resources, v. 11, p. 423\u2013434, 2011.","title":"Phylodynamics using EBSP"},{"location":"BEAST%2BEBSP_ENG/#phylogenetics-analysis-with-extended-bayesian-skyline-plots-ebsp-using-beast","text":"","title":"Phylogenetics analysis with Extended Bayesian Skyline Plots (EBSP) using BEAST"},{"location":"BEAST%2BEBSP_ENG/#diego-gomes-teixeira-phd-and-joao-paulo-m-s-lima-phd-associate-professor","text":"Bioinformatics Multidisciplinary Environment - BioME , Universidade Federal do Rio Grande do Norte.","title":"Diego Gomes Teixeira (Ph.D.) and Jo\u00e3o Paulo M S Lima (Ph.D., Associate Professor)"},{"location":"BEAST%2BEBSP_ENG/#introduction","text":"BEAST is a framework that uses an evolutionary approach based on a Bayesian model, which involves a wide range of analyses, resulting in the inference of one or more phylogenies or family trees. It also includes traditional phylogenies, phylodynamics, and phylogeographic inferences, as well as coalescence analysis of the evolutionary history of a population, usually obtained from a single analysis ( Drummond et al., 2005 ; Bouckaert et al., 2014 ). The demographic history of a population leaves a signature on the genome of current representatives. The reconstruction of this history allows us to gain insights into various evolutionary processes involving population genetics, such as tracing the transmission and spread of a virus. The method for estimating population history from DNA or AA sequences depends only on the coalescing events' time and not exactly on the genealogical relationships between the sequences. For example, coalescence events occurring in rapid succession are indicative of a small gene population size ( Ho; Shapiro, 2011 ). This tutorial will guide you through a phylogenetic analysis of an alignment of ZIKA virus sequences, sampled during the outbreak period in South America. This tutorial is an adaptation of the study conducted by FARIA et al. (2016) which investigated the approximate date of introduction of the virus in the Americas by identifying a possible common ancestor among American and Asian isolates. The aim is to reproduce the results obtained in this study, with a small additional population analysis through an Extended Bayesian Skyline Plot (EBSP) .","title":"Introduction"},{"location":"BEAST%2BEBSP_ENG/#beauti","text":"","title":"BEAUTi"},{"location":"BEAST%2BEBSP_ENG/#loading-the-nexus-file","text":"To load the alignment, select the \" Import Alignment \" option from the \" File \" menu. The file Zika.nexus_Tutorial can be downloaded HERE and contains an alignment of 23 Zika Virus sequences.","title":"Loading the NEXUS file"},{"location":"BEAST%2BEBSP_ENG/#adding-the-sampling-date-of-the-sequences","text":"In the top menu, select the Tip Dates tab and then check the Use tip date box. You will have the option to manually add each of the dates in the Date field, or you can upload a pre-assembled file containing the list of sequence names and the date, separated by a tab. In this example, we will use this list, clicking on the Guess button and then selecting the read from file field. Then, load the file Tutorial_ZIKA_tips.dat .","title":"Adding the sampling date of the sequences"},{"location":"BEAST%2BEBSP_ENG/#selecting-the-model","text":"In the top menu, select the tab Site Model and the field Subset Model change to the option GTR .","title":"Selecting the model"},{"location":"BEAST%2BEBSP_ENG/#configuring-the-priors","text":"In the Priors tab at Tree.t:Tutorial_ZIKA select the Coalescent Extended Bayesian Skyline option. Then click the + and select the option MRCA Prior . In the box that will appear, set the name of the taxon you want to work in the box Taxon set label . In this example, we will give the name of taxon A for the taxon that contains the sequences from South America plus the sequence from French Polynesia, and taxon B for the sequences from South America only.","title":"Configuring the Priors"},{"location":"BEAST%2BEBSP_ENG/#configuring-discrete-features","text":"Back to the Partitions tab, let us click the + button located at the bottom of the BEAUTi window and select the option Add Discrete Trait . In the resulting box, we will set the name Locals in the box Trait Name . The next window will ask for the Trait name for each sequence. In that option, we will put the country of origin of each of the samples. Again we have the option to manually put the country name of one in one or to load a tabulated file containing the sequence name and the country name. In the Guess tab we will select the option Read from file and load the file Tutorial_ZIKA_locals.dat","title":"Configuring discrete features"},{"location":"BEAST%2BEBSP_ENG/#configuring-the-mcmc","text":"In the MCMC tab we will set the Chain Length to 50,000,000 and change the values of Log Every in the boxes tracelog , treelog.t:Tutorial_ZIKA , treeWithTraitLogger.Locals and EBSPLogger to 5,000. Depending on your computer, this chain size can be considerable, and the program will take a long time running. However, it is necessary for EBSP. If you cannot run it, use the files already run at the end of this tutorial. After this step, go to File > Save and save the .xml file.","title":"Configuring the MCMC"},{"location":"BEAST%2BEBSP_ENG/#beast","text":"Before running BEAST2, we have to install some additional extensions to perform these analyses. We will discuss these steps in a synchronous meeting. In the BEAST window, in the BEAST XML FILE field, we will load the .xml file created by BEAUTi and click Run.","title":"BEAST"},{"location":"BEAST%2BEBSP_ENG/#tree-annotator","text":"At this stage, we will discard the first trees generated by BEAST from the MCMC. In the Burnin percentage box, we will put for the program to remove 10% of the initial trees. In the Node heights option, we will select the Median heights option, and then we will load the BEAST output, the Locals_tree_with_trait.trees , in the Input Tree File field, and define the name of the output file in the Output File option.","title":"Tree Annotator"},{"location":"BEAST%2BEBSP_ENG/#figtree","text":"In FigTree, load the file Local_tree_with_trait.tree , then adjust the branches.","title":"FigTree"},{"location":"BEAST%2BEBSP_ENG/#tracer","text":"In the Tracer program, we will load the BEAST log file to access some information from the analysis. Clicking on the + we will load the zika_tutorial.log file. Then, we will select, in the Traces tab, the variables mrcatime(A) and mrcatime(B) . Observe the results.","title":"TRACER"},{"location":"BEAST%2BEBSP_ENG/#constructing-the-ebsp-plot","text":"Open RStudio (or other R environment) and enter the following code: plotEBSP(\u201c/File_Folder/EBSP.log\", useHPD=FALSE, log=\"y\", xlim=c(0,5)) Remember to switch the File_Folder to the location where you saved the EBSP.log file. Compare the graph to the tree.","title":"Constructing the EBSP Plot"},{"location":"BEAST%2BEBSP_ENG/#using-the-package-ebspanalyser","text":"The EBSPAnalyser package produces a log file with columns time, mean, median, 95% upper and lower, which you can import in a spreadsheet or to your favorite plot software and use to draw a graph. To run in Linux/MacOS, open a terminal window and use the follow command: java -cp $(dir)/beast.jar beast.app.tools.EBSPAnalyser where $(dir) points to the directory where beast.jar is located. A window pops up where you specify the EBSP.log file and some other settings. Retrieved and adapted from Beast2/EBSPAnalyzer .","title":"Using the package EBSPAnalyser"},{"location":"BEAST%2BEBSP_ENG/#files-generated-after-the-beast-execution","text":"The files generated from the above steps are available at the link below: Tutorial Zika Filogenia.zip","title":"Files generated after the BEAST execution"},{"location":"BEAST%2BEBSP_ENG/#references","text":"Bouckaert, R. et al. BEAST 2: A Software Platform for Bayesian Evolutionary Analysis. PLoS Computational Biology, v. 10, n. 4, p. e1003537, 10 abr. 2014. Drummond, A. J. et al. Bayesian coalescent inference of past population dynamics from molecular sequences. Molecular Biology and Evolution, v. 22, p. 1185\u20131192, 2005. Faria, N. R. et al. Zika virus in the Americas: Early epidemiological and genetic findings. Science (New York, N.Y.), v. 5036, n. March, p. aaf5036, 2016. Ho, S. Y. W.; Shapiro, B. Skyline-plot methods for estimating demographic history from nucleotide sequences. Molecular Ecology Resources, v. 11, p. 423\u2013434, 2011.","title":"References"},{"location":"First_Tutorial_ENG/","text":"First Tutorial 1st Part - Knowing your sequences To execute a phylogenetic analysis, the first thing you're going to have to do is to find a suitable marker (nucleotide or protein sequence). Then, you will construct the dataset (i.e., a Multiple Sequence Alignment - MSA) to use in the subsequent phylogeny pipeline. In this example, you're going to start from sequences below, using the .fasta file. The first thing to do is to identify this sequence using BLAST searches. For this, you can use BLASTn or BLASTx. >HomoSapiens AUGACCCCAAUACGCAAAAUUAACCCCCUAAUAAAAUUAAUUAACCACUCAUUCAUCGAC CUCCCCACCCCAUCCAACAUCUCCGCAUGAUGAAACUUCGGCUCACUCCUUGGCGCCUGC CUGAUCCUCCAAAUCACCACAGGACUAUUCCUAGCCAUACACUACUCACCAGACGCCUCA ACCGCCUUUUCAUCAAUCGCCCACAUCACUCGAGACGUAAAUUAUGGCUGAAUCAUCCGC UACCUUCACGCCAAUGGCGCCUCAAUAUUCUUUAUCUGCCUCUUCCUACACAUCGGGCGA GGCCUAUAUUACGGAUCAUUUCUCUACUCAGAAACCUGAAACAUCGGCAUUAUCCUCCUG CUUGCAACUAUAGCAACAGCCUUCAUAGGCUAUGUCCUCCCGUGAGGCCAAAUAUCAUUC UGAGGGGCCACAGUAAUUACAAACUUACUAUCCGCCAUCCCAUACAUUGGGACAGACCUA GUUCAAUGAAUCUGAGGAGGCUACUCAGUAGACAGUCCCACCCUCACACGAUUCUUUACC UUUCACUUCAUCUUACCCUUCAUUAUUGCAGCCCUAGCAGCACUCCACCUCCUAUUCUUG CACGAAACGGGAUCAAACAACCCCCUAGGAAUCACCUCCCAUUCCGAUAAAAUCACCUUC CACCCUUACUACACAAUCAAAGACGCCCUCGGCUUACUUCUCUUCCUUCUCUCCUUAAUG ACAUUAACACUAUUCUCACCAGACCUCCUAGGCGACCCAGACAAUUAUACCCUAGCCAAC CCCUUAAACACCCCUCCCCACAUCAAGCCCGAAUGAUAUUUCCUAUUCGCCUACACAAUU CUCCGAUCCGUCCCUAACAAACUAGGAGGCGUCCUUGCCCUAUUACUAUCCAUCCUCAUC CUAGCAAUAAUCCCCAUCCUCCAUAUAUCCAAACAACAAAGCAUAAUAUUUCGCCCACUA AGCCAAUCACUUUAUUGACUCCUAGCCGCAGACCUCCUCAUUCUAACCUGAAUCGGAGGA CAACCAGUAAGCUACCCUUUUACCAUCAUUGGACAAGUAGCAUCCGUACUAUACUUCACA ACAAUCCUAAUCCUAAUACCAACUAUCUCCCUAAUUGAAAACAAAAUACUCAAA Often the target sequence is obtained by DNA sequencing (in genome or transcriptome designs), as these methods are usually more accessible than methods of obtaining amino acid sequences. To search for similarity from the nucleotide coding sequence, you have two options: Translate the nucleotide sequence into the 3 frames (open reading frames - ORFs) and to use the resulting sequences as input in BLASTp similarity searches. This translation can be done using tools from EXPASY or EBI . Use BLASTx . This variation of BLAST translates the input nucleotide sequence (Query) and compares it to protein banks. To be more straightforward, you could use BLASTx . Steps: Open the NCBI-BLAST site. Click in blastx. The following page will open. Paste your sequence in the indicated field and choose the nr database. Then you can click BLAST button. After a few moments, the BLAST search result will appear, as below: Click in Alignments and analyze the results. You can also translate the sequence using the frame +1 and perform a BLASTp search with the resulting amino acid sequence. Questions 1- Which do protein this sequence codes? 2- What is the function of this protein? 2nd Part - Sequence Alignment Let us suppose that you want to infer phylogeny, using the above sequence. And using BLAST searches, you retrieved homologous sequences from other vertebrate species. All you have to do is to find homologous sequences using BLAST searches. However, sometimes it is better to restrict the search database, excluding the species Homo sapiens , using the option Organism from the initial BLAST page. We're going to give you these sequences, to save you time from getting them. So, for example, you've got the following sequences: >Masturus_lanceolatus AUGGCAAGCCUGCGUAAAACCCACCCACUAUUAAAAAUUGCAAACGACGCACUAGUCGAC CUCCCCACCCCUUCAAACAUCUCCGCCUGAUGGAAUUUUGGCUCCCUACUUGGACUCUGC CUAAUUAUCCAAAUUCUUACUGGACUAUUCCUCGCAAUACAUUACACCUCCGAUAUCGCU ACUGCAUUCUCAUCCGUGGCACAUAUUUGCCGAGAUGUAAACUACGGCUGACUCAUCCGC AACCUGCAUGCUAACGGAGCAUCUUUCUUCUUUAUUUGUAUUUAUAUGCACAUCGCCCGA GGCCUAUACUAUGGCUCCUACCUCUAUAAAGAAACCUGAAACGUCGGAGUAGUCCUAUUA CUCUUGGUCAUGGCGACCGCUUUCGUAGGCUACGUACUUCCCUGAGGACAAAUAUCUUUC UGGGGCGCUACUGUUAUUACUAACCUCUUCUCCGCCGUCCCCUAUGUGGGCGAUGCCCUC GUACAAUGGAUCUGAGGAGGAUUCUCAGUUGACAACGCCACAUUAACACGAUUCUUUGCC UUCCAUUUCCUCCUCCCCUUCAUCGUUACAGCAGUCACCCUAAUCCAUUUACUAUUCCUC CACGAAACAGGCUCAAAUAACCCCCUGGGGCUAAGUUCAAACACGGACAAAAUCUCUUUC CACCCUUACUUCUCCUACAAAGAUCUCUUAGGCUUCACAAUCAUGCUUAUUGCCCUCACA UCCCUAGCACUCUUCUCCCCCAACCUCCUGGGAGACCCUGACAACUUCACCCCCGCCAAC CCCCUUGUCACCCCACCCCACAUCAAGCCCGAGUGAUACUUCCUGUUCGCUUACGCCAUU CUUCGCUCCAUCCCAAAUAAAUUAGGAGGAGUCCUUGCCUUGCUGGCCUCCAUCCUAGUC CUAAUAGUCGUACCGCUUCUCCACACAUCCAAACAGCGAGGCCUCACGUUCCGCCCCCUU ACCCAAUUCCUAUUUUGAACCUUAAUUGCCAACAUUAUUAUUCUAACAUGAAUUGGAGGA AUACCCGUAGAACACCCAUUCGUGAUCAUCGGCCAAAUCGCCUCCGUCCUUUACUUCUCC CUAUUCCUAGUCUUCAUCCCCCUCACAGGCUGACUAGAAAACAAAGCCCUUGAAUGGUCC >Homo_sapiens AUGACCCCAAUACGCAAAAUUAACCCCCUAAUAAAAUUAAUUAACCACUCAUUCAUCGAC CUCCCCACCCCAUCCAACAUCUCCGCAUGAUGAAACUUCGGCUCACUCCUUGGCGCCUGC CUGAUCCUCCAAAUCACCACAGGACUAUUCCUAGCCAUACACUACUCACCAGACGCCUCA ACCGCCUUUUCAUCAAUCGCCCACAUCACUCGAGACGUAAAUUAUGGCUGAAUCAUCCGC UACCUUCACGCCAAUGGCGCCUCAAUAUUCUUUAUCUGCCUCUUCCUACACAUCGGGCGA GGCCUAUAUUACGGAUCAUUUCUCUACUCAGAAACCUGAAACAUCGGCAUUAUCCUCCUG CUUGCAACUAUAGCAACAGCCUUCAUAGGCUAUGUCCUCCCGUGAGGCCAAAUAUCAUUC UGAGGGGCCACAGUAAUUACAAACUUACUAUCCGCCAUCCCAUACAUUGGGACAGACCUA GUUCAAUGAAUCUGAGGAGGCUACUCAGUAGACAGUCCCACCCUCACACGAUUCUUUACC UUUCACUUCAUCUUACCCUUCAUUAUUGCAGCCCUAGCAGCACUCCACCUCCUAUUCUUG CACGAAACGGGAUCAAACAACCCCCUAGGAAUCACCUCCCAUUCCGAUAAAAUCACCUUC CACCCUUACUACACAAUCAAAGACGCCCUCGGCUUACUUCUCUUCCUUCUCUCCUUAAUG ACAUUAACACUAUUCUCACCAGACCUCCUAGGCGACCCAGACAAUUAUACCCUAGCCAAC CCCUUAAACACCCCUCCCCACAUCAAGCCCGAAUGAUAUUUCCUAUUCGCCUACACAAUU CUCCGAUCCGUCCCUAACAAACUAGGAGGCGUCCUUGCCCUAUUACUAUCCAUCCUCAUC CUAGCAAUAAUCCCCAUCCUCCAUAUAUCCAAACAACAAAGCAUAAUAUUUCGCCCACUA AGCCAAUCACUUUAUUGACUCCUAGCCGCAGACCUCCUCAUUCUAACCUGAAUCGGAGGA CAACCAGUAAGCUACCCUUUUACCAUCAUUGGACAAGUAGCAUCCGUACUAUACUUCACA ACAAUCCUAAUCCUAAUACCAACUAUCUCCCUAAUUGAAAACAAAAUACUCAAA >Bos_taurus AUGACUAACAUUCGAAAGUCCCACCCACUAAUAAAAAUUGUAAACAAUGCAUUCAUCGAC CUUCCAGCCCCAUCAAACAUUUCAUCAUGAUGAAAUUUCGGUUCCCUCCUGGGAAUCUGC CUAAUCCUACAAAUCCUCACAGGCCUAUUCCUAGCAAUACACUACACAUCCGACACAACA ACAGCAUUCUCCUCUGUUACCCAUAUCUGCCGAGACGUGAACUACGGCUGAAUCAUCCGA UACAUACACGCAAACGGAGCUUCAAUGUUUUUUAUCUGCUUAUAUAUGCACGUAGGACGA GGCUUAUAUUACGGGUCUUACACUUUUCUAGAAACAUGAAAUAUUGGAGUAAUCCUUCUG CUCACAGUAAUAGCCACAGCAUUUAUAGGAUACGUCCUACCAUGAGGACAAAUAUCAUUC UGAGGAGCAACAGUCAUCACCAACCUCUUAUCAGCAAUCCCAUACAUCGGCACAAAUUUA GUCGAAUGAAUCUGAGGCGGAUUCUCAGUAGACAAAGCAACCCUUACCCGAUUCUUCGCU UUCCAUUUUAUCCUUCCAUUUAUCAUCAUAGCAAUUGCCAUAGUCCACCUACUAUUCCUC CACGAAACAGGCUCCAACAACCCAACAGGAAUUUCCUCAGACGUAGACAAAAUCCCAUUC CACCCCUACUAUACCAUUAAGGACAUCUUAGGGGCCCUCUUACUAAUUCUAGCUCUAAUA CUACUAGUACUAUUCGCACCCGACCUCCUCGGAGACCCAGAUAACUACACCCCAGCCAAU CCACUCAACACACCCCCUCACAUCAAACCCGAGUGAUACUUCUUAUUUGCAUACGCAAUC UUACGAUCAAUCCCCAACAAACUAGGAGGAGUACUAGCCCUAGCCUUCUCUAUCCUAAUU CUUGCUCUAAUCCCCCUACUACACACCUCCAAACAACGAAGCAUAAUAUUCCGACCACUC AGCCAAUGCCUAUUCUGAGCCCUAGUAGCAGACCUACUGACACUCACAUGAAUUGGAGGA CAACCAGUCGAACACCCAUAUAUCACCAUCGGACAACUAGCAUCUGUCCUAUACUUUCUC CUCAUCCUAGUGCUAAUACCAACGGCCGGCACAAUCGAAAACAAAUUACUAAAAUGA >Balaenoptera_musculus AUGACCAACAUCCGAAAAACACACCCACUAAUAAAAAUCAUCAACGAUGCAUUCAUUGAU CUCCCUACCCCAUCAAACAUCUCCUCAUGAUGAAACUUCGGCUCCCUACUCGGCCUCUGC UUAAUUGUACAAAUCCUAACAGGCCUAUUCCUAGCAAUACACUAUACACCAGACACAAUA ACCGCCUUCUCAUCAGUCACACAUAUUUGCCGAGACGUAAACUAUGGCUGAGUUAUUCGG UACUUACAUGCAAACGGAGCCUCCAUAUUCUUCAUCUGCCUCUACGCCCACAUGGGACGA GGUCUAUACUACGGCUCCCACGCUUUUCGAGAAACAUGAAAUAUUGGAGUUAUUCUACUA UUCACGGUCAUAGCCACUGCAUUCGUAGGCUACGUCCUGCCCUGAGGACAAAUAUCAUUC UGAGGCGCAACCGUCAUCACCAACCUCCUAUCAGCAAUCCCAUACAUUGGUACUACCCUA GUCGAAUGAAUCUGAGGCGGUUUUUCUGUGGAUAAAGCAACACUAACACGCUUCUUUGCC UUCCACUUCAUUCUCCCCUUCAUCAUUAUAGCAUUAGCAAUCGUCCACCUCAUCUUCCUU CACGAAACAGGAUCCAACAACCCCACAGGUAUCCCAUCUGACAUAGAUAAAAUUCCAUUC CACCCCUACUACACAAUUAAAGACAUUCUAGGCGCCCUACUACUAAUCCUAACCCUACUA AUAUUAACUCUAUUUGCACCCGACUUACUCGGAGACCCAGACAACUACACCCCAGCAAAC CCACUCAGUACCCCAGCACACAUUAAACCAGAGUGAUAUUUCCUAUUUGCAUAUGCAAUC CUACGAUCAAUCCCCAACAAAUUAGGCGGAGUCUUAGCCCUACUACUCUCAAUCCUAGUC CUAGCUCUAAUCCCAAUACUCCACACAUCCAAACAACGAAGCAUAAUAUUCCGACCCUUU AGCCAAUUCCUGUUUUGAGUACUGGUCGCAGACCUACUCACCCUAACGUGGAUCGGCGGC CAACCCGUAGAACACCCCUAUGUAAUUGUAGGCCAACUCGCAUCCAUCCUCUACUUCCUC UUAAUUCUAGUGUUAAUACCAGUAACUAGUCUUAUCGAAAAUAAACUUAUAAAAUGA >Pongo_pygmaeus AUGACCCCAAUACGCAAAACCAACCCACUAAUAAAAUUAAUUAACCACUCACUCAUCGAC CUCCCCACCCCAUCAAACAUCUCUGCAUGAUGGAACUUCGGCUCACUUCUAGGCGCCUGC UUAAUCAUCCAAACCAUCACUGGACUAUUCCUAGCCAUACAUUACUCACCAGACGCCACU ACCGCCUUUUCAUCAAUCGCCCAUAUUACUCGAGAUGUAAACUACGGCUGAAUAAUCCGC CACCUUCACGCUAACGGCGCCUCAAUGCUCUUUAUCUGCCUCUUCCUACACAUUGGCCGA GGCUUAUACUAUGGCUCAUUCACCCACUUAGAAACCUGAAACAUUGGUAUUAUCCUACUG UUUAUAACCAUAAUAACAGCCUUCAUAGGCUACGUCCUCCCAUGAGGCCAAAUAUCCUUC UGAGGAGCCACAGUAAUUACAAACCUAUUAUCCGCCGUCCCAUACAUUGGAACAGACCUA GUCCAAUGGGUCUGAGGGGGCUACUCAGUAAAUAGCCCCACUCUAACACGAUUCUUUACC CUUCACUUCAUACUACCUUUCAUCAUUACAGCUCUAACAACCCUUCACCUCCUAUUCCUU CACGAAACAGGAUCAAAUAACCCCCUGGGAAUCCCCUCCCACUCCGAUAAAAUCACUUUC CACCCCUACUAUACAAUUAAAGACAUCCUAGGCCUACUCCUUUUUCUCCUCGCCCUAAUA ACAUUAACACUACUCUCACCAGACCUCCUAAGCGACCCAGACAACUACACCUUAGCUAAC CCCCUAAGCACCCCACCCCACAUUAAGCCCGAAUGAUACUUCCUAUUCGCCUACGCAAUC CUACGAUCCGUCCCCAACAAACUAGGAGGUGUAAUAGCCCUCAUGCUAUCUAUCCUAAUC CUAACAACAAUCCCCGCUCUCCACACAUCCAAGCAACAGAGCAUAACAUUCCGCCCAUUA AGCCAAUUCCUAUACUGACUCUUAAUCACCGACCUCCUAGUUCUCACCUGAAUUGGAGGA CAACCAGUAAGCUACCCCUUUAUUACUAUUGGCCAAGUAGCAUCCGUACUAUACUUUACC ACUAUCCUACUCCUUAUACCAACCUCUUCCCUGAUCGAAAACUACAUACUCAAAUGAACC >Pan_troglodytes AUGACCCCGACACGCAAAAUUAACCCACUAAUAAAAUUAAUUAAUCACUCAUUUAUCGAC CUCCCCACCCCAUCCAACAUUUCCGCAUGAUGGAACUUCGGCUCACUUCUCGGCGCCUGC CUAAUCCUUCAAAUUACCACAGGAUUAUUCCUAGCUAUACACUACUCACCAGACGCCUCA ACCGCCUUCUCGUCGAUCGCCCACAUCACCCGAGACGUAAACUAUGGUUGGAUCAUCCGC UACCUCCACGCUAACGGCGCCUCAAUAUUUUUUAUCUGCCUCUUCCUACACAUCGGCCGA GGUCUAUAUUACGGCUCAUUUCUCUACCUAGAAACCUGAAACAUUGGCAUUAUCCUCUUG CUCACAACCAUAGCAACAGCCUUUAUGGGCUAUGUCCUCCCAUGAGGCCAAAUAUCCUUC UGAGGAGCCACAGUAAUUACAAACCUACUGUCCGCUAUCCCAUACAUCGGAACAGACCUG GUCCAGUGAGUCUGAGGAGGCUACUCAGUAGACAGCCCUACCCUUACACGAUUCUUCACC UUCCACUUUAUCUUACCCUUCAUCAUCACAGCCCUAACAACACUUCAUCUCCUAUUCUUA CACGAAACAGGAUCAAAUAACCCCCUAGGAAUCACCUCCCACUCCGACAAAAUUACCUUC CACCCCUACUACACAAUCAAAGAUAUCCUUGGCUUAUUCCUUUUCCUCCUUAUCCUAAUG ACAUUAACACUAUUCUCACCAGGCCUCCUAGGCGAUCCAGACAACUAUACCCUAGCUAAC CCCCUAAACACCCCACCCCACAUUAAACCCGAGUGAUACUUUCUAUUUGCCUACACAAUC CUCCGAUCCAUCCCCAACAAACUAGGAGGCGUCCUCGCCCUACUACUAUCUAUCCUAAUC CUAACAGCAAUCCCUGUCCUCCACACAUCCAAACAACAAAGCAUAAUAUUUCGCCCACUA AGCCAACUGCUUUACUGACUCCUAGCCACAGACCUCCUCAUCCUAACCUGAAUCGGAGGA CAACCAGUAAGCUACCCCUUCAUCACCAUCGGACAAAUAGCAUCCGUAUUAUACUUCACA ACAAUCCUAAUCCUAAUACCAAUCGCCUCUCUAAUCGAAAACAAAAUACUUGAAUGAACC >Gallus_gallus AUGGCACCCAACAUUCGAAAAUCCCACCCCCUACUAAAAAUAAUUAACAACUCCCUAAUC GACCUCCCAGCCCCAUCCAACAUCUCUGCUUGAUGAAAUUUCGGCUCCCUAUUAGCAGUC UGCCUCAUGACCCAAAUCCUCACCGGCCUACUACUAGCCAUGCACUACACAGCAGACACA UCCCUAGCCUUCUCCUCCGUAGCCCACACUUGCCGGAACGUACAAUACGGCUGACUCAUC CGGAAUCUCCACGCAAACGGCGCCUCAUUCUUCUUCAUCUGUAUCUUCCUUCACAUCGGA CGAGGCCUAUACUACGGCUCCUACCUCUACAAGGAAACCUGAAACACAGGAGUAAUCCUC CUCCUCACACUCAUAGCCACCGCCUUUGUGGGCUAUGUUCUCCCAUGGGGCCAAAUAUCA UUCUGAGGGGCCACCGUUAUCACAAACCUAUUCUCAGCAAUUCCCUACAUUGGACACACC CUAGUAGAGUGAGCCUGAGGGGGAUUCUCAGUCGACAACCCAACCCUUACCCGAUUCUUC GCCUUACACUUCCUCCUCCCCUUUGCAAUCGCAGGUAUUACUAUCAUCCACCUCACCUUC CUACACGAAUCAGGCUCAAACAACCCCCUAGGCAUCUCAUCCGACUCUGACAAAAUUCCA UUUCACCCAUACUACUCCUUCAAAGACAUUCUGGGCUUAACUCUCAUACUCACCCCAUUC CUAACACUAGCCCUAUUCUCCCCCAACCUCCUAGGAGACCCAGAAAACUUCACCCCAGCA AACCCACUAGUAACCCCCCCACAUAUCAAACCAGAAUGAUAUUUUCUAUUCGCCUAUGCC AUCCUACGCUCCAUCCCCAACAAACUUGGAGGUGUACUAGCCCUAGCAGCCUCAGUCCUC AUCCUCUUCCUAAUCCCCUUCCUCCACAAAUCUAAACAACGAACAAUAACCUUCCGACCA CUCUCCCAAACCUUAUUCUGACUUCUAGUAGCCAACCUUCUUAUCCUAACCUGAAUCGGA AGCCAACCAGUAGAACACCCCUUCAUCAUCAUUGGCCAAAUAGCAUCCCUCUCUUACUUC ACCAUCCUACUUAUCCUCUUCCCCACAAUCGGAACACUAGAAAACAAAAUACUCAACUAC >Alligator_mississippiensis AUGACCCACCAACUACGAAAAUCCCACCCAAUCAUUAAACUCAUCAACCGCUCCCUAAUU GACCUACCAACACCCUCAAACAUCUCCGCUUGAUGAAACUUUGGAUCACUACUAGGCCUA ACCCUAUUAAUUCAGAUUCUAACAGGAUUCUUCUUAAUAAUGCACUUUUCAUCAAGCGAU ACUCUAGCAUUUUCAUCUGUAUCCUACACCUCCCGCGAAGUCUGAUUUGGAUGACUCAUC CGCAACCUCCACACAAAUGGGGCCUCCCUGUUCUUUAUAUUUAUCUUUCUUCACAUCGGA CGAGGCCUAUACUACACAUCAUAUCUUCACGAAAGCACAUGAAAUAUUGGAGUAAUCAUA CUUCUACUCCUAAUAGCCACAGCAUUUAUAGGCUAUGUUCUCCCAUGAGGACAAAUAUCA UUCUGAGGAGCAACCGUAAUCACGAAUCUACUUUCUGCCACACCCUACGUUGGAAGCACU GUCGUGCCAUGAAUUUGAGGCGGCCCCUCUGUUGACAACGCAACACUUACACGCUUCACU GCCCUACACUUCCUCCUUCCAUUCGCCCUAUUGGCUUCACUCAUCACCCACCUGAUCUUC CUCCAUGAACGAGGAUCAUUUAACCCCCUAGGAAUUAGCCCAAAUGCUGACAAAAUCCCA UUCCACCCCUACUUCACCAUAAAAGACGCCCUAGGAGCAGCACUAGCUGCCUCCUCACUA CUCAUCUUAGCUCUCUACCUACCAGCCCUAUUAGGGGACCCUGAAAACUUCACCCCAGCA AAUUCCAUAAUUACCCCAACACACAUCAAACCCGAAUGGUACUUCCUAUUUGCUUAUGCC AUUCUACGAUCUAUUCCAAAUAAGUUAGGAGGAGUACUAGCAAUAUUCUCAUCCAUUUUA GUCCUAUUCCUAAUACCCGCCCUACACACAGCAAAACAACAACCAAUAUCAAUACGCCCU AUAUCUCAGCUUCUAUUUUGAGCCCUUACCCUGGACUUCCUCUUACUCACAUGAAUCGGA GGCCAACCAGUAAACCCCCCAUAUAUUUUAAUUGGCCAAACUGCCUCCCUAUUCUACUUC AUCAUCAUCCUAAUCCUCAUACCAAUAGCAGGCCUCUUAGAGAACAAAAUAGUUGAACCC ACCUAUGUUACCCCUAAG You can also download this multifasta file HERE . The tsv file with the NCBI taxonomy ID (TxID) can be obtained HERE . Later, we are going to use this file to annotate the tree using TaxOnTree . This step is very useful, especially if you are not familiar with the complete taxonomic classification of the OTUs you are currently working. The next step on this tutorial is to align these sequences to get our dataset ready. Since these sequences are not difficult to align, we can use the Clustal program. You can use either the installed programs Jalview or MEGAX. In this example, we'll show the alignment steps using Jalview. MEGAX also aligns nucleotides and proteins sequences, using the programs Clustal or Muscle. If you want to use MEGA for the alignment, I recommend you to use Clustal program. Steps: Open Jalview. Close all example windows. Open the multifasta file, following the menu, shown in the figure below: Then, put some color in the alignment, using the following options: After that, you can start the alignment process, using Clustal, as demonstrated in the figure below: The aligned sequences will appear right after the job is done. Again, put some color and inspect the alignment. Now we're going to save this alignment. However, first, we have to change some options in Jalview. In Jalview main window, go to the menu Tools and after that, press Preferences . The following window will appear: Press the right arrow until you find the Output options. Make sure the options are the same as the above figure. Press OK . After that, you can save your alignment, following the menu File > Save as... Save your alignment in fasta format. If you want the exported alignment to show the start-end sites for each sequence, you do not need to execute the above steps. However, keep in mind that this information can (and in most cases, will) bring incompatibilities with some programs and tools.","title":"First Tutorial"},{"location":"First_Tutorial_ENG/#first-tutorial","text":"","title":"First Tutorial"},{"location":"First_Tutorial_ENG/#1st-part-knowing-your-sequences","text":"To execute a phylogenetic analysis, the first thing you're going to have to do is to find a suitable marker (nucleotide or protein sequence). Then, you will construct the dataset (i.e., a Multiple Sequence Alignment - MSA) to use in the subsequent phylogeny pipeline. In this example, you're going to start from sequences below, using the .fasta file. The first thing to do is to identify this sequence using BLAST searches. For this, you can use BLASTn or BLASTx. >HomoSapiens AUGACCCCAAUACGCAAAAUUAACCCCCUAAUAAAAUUAAUUAACCACUCAUUCAUCGAC CUCCCCACCCCAUCCAACAUCUCCGCAUGAUGAAACUUCGGCUCACUCCUUGGCGCCUGC CUGAUCCUCCAAAUCACCACAGGACUAUUCCUAGCCAUACACUACUCACCAGACGCCUCA ACCGCCUUUUCAUCAAUCGCCCACAUCACUCGAGACGUAAAUUAUGGCUGAAUCAUCCGC UACCUUCACGCCAAUGGCGCCUCAAUAUUCUUUAUCUGCCUCUUCCUACACAUCGGGCGA GGCCUAUAUUACGGAUCAUUUCUCUACUCAGAAACCUGAAACAUCGGCAUUAUCCUCCUG CUUGCAACUAUAGCAACAGCCUUCAUAGGCUAUGUCCUCCCGUGAGGCCAAAUAUCAUUC UGAGGGGCCACAGUAAUUACAAACUUACUAUCCGCCAUCCCAUACAUUGGGACAGACCUA GUUCAAUGAAUCUGAGGAGGCUACUCAGUAGACAGUCCCACCCUCACACGAUUCUUUACC UUUCACUUCAUCUUACCCUUCAUUAUUGCAGCCCUAGCAGCACUCCACCUCCUAUUCUUG CACGAAACGGGAUCAAACAACCCCCUAGGAAUCACCUCCCAUUCCGAUAAAAUCACCUUC CACCCUUACUACACAAUCAAAGACGCCCUCGGCUUACUUCUCUUCCUUCUCUCCUUAAUG ACAUUAACACUAUUCUCACCAGACCUCCUAGGCGACCCAGACAAUUAUACCCUAGCCAAC CCCUUAAACACCCCUCCCCACAUCAAGCCCGAAUGAUAUUUCCUAUUCGCCUACACAAUU CUCCGAUCCGUCCCUAACAAACUAGGAGGCGUCCUUGCCCUAUUACUAUCCAUCCUCAUC CUAGCAAUAAUCCCCAUCCUCCAUAUAUCCAAACAACAAAGCAUAAUAUUUCGCCCACUA AGCCAAUCACUUUAUUGACUCCUAGCCGCAGACCUCCUCAUUCUAACCUGAAUCGGAGGA CAACCAGUAAGCUACCCUUUUACCAUCAUUGGACAAGUAGCAUCCGUACUAUACUUCACA ACAAUCCUAAUCCUAAUACCAACUAUCUCCCUAAUUGAAAACAAAAUACUCAAA Often the target sequence is obtained by DNA sequencing (in genome or transcriptome designs), as these methods are usually more accessible than methods of obtaining amino acid sequences. To search for similarity from the nucleotide coding sequence, you have two options: Translate the nucleotide sequence into the 3 frames (open reading frames - ORFs) and to use the resulting sequences as input in BLASTp similarity searches. This translation can be done using tools from EXPASY or EBI . Use BLASTx . This variation of BLAST translates the input nucleotide sequence (Query) and compares it to protein banks. To be more straightforward, you could use BLASTx . Steps: Open the NCBI-BLAST site. Click in blastx. The following page will open. Paste your sequence in the indicated field and choose the nr database. Then you can click BLAST button. After a few moments, the BLAST search result will appear, as below: Click in Alignments and analyze the results. You can also translate the sequence using the frame +1 and perform a BLASTp search with the resulting amino acid sequence.","title":"1st Part - Knowing your sequences"},{"location":"First_Tutorial_ENG/#questions","text":"1- Which do protein this sequence codes? 2- What is the function of this protein?","title":"Questions"},{"location":"First_Tutorial_ENG/#2nd-part-sequence-alignment","text":"Let us suppose that you want to infer phylogeny, using the above sequence. And using BLAST searches, you retrieved homologous sequences from other vertebrate species. All you have to do is to find homologous sequences using BLAST searches. However, sometimes it is better to restrict the search database, excluding the species Homo sapiens , using the option Organism from the initial BLAST page. We're going to give you these sequences, to save you time from getting them. So, for example, you've got the following sequences: >Masturus_lanceolatus AUGGCAAGCCUGCGUAAAACCCACCCACUAUUAAAAAUUGCAAACGACGCACUAGUCGAC CUCCCCACCCCUUCAAACAUCUCCGCCUGAUGGAAUUUUGGCUCCCUACUUGGACUCUGC CUAAUUAUCCAAAUUCUUACUGGACUAUUCCUCGCAAUACAUUACACCUCCGAUAUCGCU ACUGCAUUCUCAUCCGUGGCACAUAUUUGCCGAGAUGUAAACUACGGCUGACUCAUCCGC AACCUGCAUGCUAACGGAGCAUCUUUCUUCUUUAUUUGUAUUUAUAUGCACAUCGCCCGA GGCCUAUACUAUGGCUCCUACCUCUAUAAAGAAACCUGAAACGUCGGAGUAGUCCUAUUA CUCUUGGUCAUGGCGACCGCUUUCGUAGGCUACGUACUUCCCUGAGGACAAAUAUCUUUC UGGGGCGCUACUGUUAUUACUAACCUCUUCUCCGCCGUCCCCUAUGUGGGCGAUGCCCUC GUACAAUGGAUCUGAGGAGGAUUCUCAGUUGACAACGCCACAUUAACACGAUUCUUUGCC UUCCAUUUCCUCCUCCCCUUCAUCGUUACAGCAGUCACCCUAAUCCAUUUACUAUUCCUC CACGAAACAGGCUCAAAUAACCCCCUGGGGCUAAGUUCAAACACGGACAAAAUCUCUUUC CACCCUUACUUCUCCUACAAAGAUCUCUUAGGCUUCACAAUCAUGCUUAUUGCCCUCACA UCCCUAGCACUCUUCUCCCCCAACCUCCUGGGAGACCCUGACAACUUCACCCCCGCCAAC CCCCUUGUCACCCCACCCCACAUCAAGCCCGAGUGAUACUUCCUGUUCGCUUACGCCAUU CUUCGCUCCAUCCCAAAUAAAUUAGGAGGAGUCCUUGCCUUGCUGGCCUCCAUCCUAGUC CUAAUAGUCGUACCGCUUCUCCACACAUCCAAACAGCGAGGCCUCACGUUCCGCCCCCUU ACCCAAUUCCUAUUUUGAACCUUAAUUGCCAACAUUAUUAUUCUAACAUGAAUUGGAGGA AUACCCGUAGAACACCCAUUCGUGAUCAUCGGCCAAAUCGCCUCCGUCCUUUACUUCUCC CUAUUCCUAGUCUUCAUCCCCCUCACAGGCUGACUAGAAAACAAAGCCCUUGAAUGGUCC >Homo_sapiens AUGACCCCAAUACGCAAAAUUAACCCCCUAAUAAAAUUAAUUAACCACUCAUUCAUCGAC CUCCCCACCCCAUCCAACAUCUCCGCAUGAUGAAACUUCGGCUCACUCCUUGGCGCCUGC CUGAUCCUCCAAAUCACCACAGGACUAUUCCUAGCCAUACACUACUCACCAGACGCCUCA ACCGCCUUUUCAUCAAUCGCCCACAUCACUCGAGACGUAAAUUAUGGCUGAAUCAUCCGC UACCUUCACGCCAAUGGCGCCUCAAUAUUCUUUAUCUGCCUCUUCCUACACAUCGGGCGA GGCCUAUAUUACGGAUCAUUUCUCUACUCAGAAACCUGAAACAUCGGCAUUAUCCUCCUG CUUGCAACUAUAGCAACAGCCUUCAUAGGCUAUGUCCUCCCGUGAGGCCAAAUAUCAUUC UGAGGGGCCACAGUAAUUACAAACUUACUAUCCGCCAUCCCAUACAUUGGGACAGACCUA GUUCAAUGAAUCUGAGGAGGCUACUCAGUAGACAGUCCCACCCUCACACGAUUCUUUACC UUUCACUUCAUCUUACCCUUCAUUAUUGCAGCCCUAGCAGCACUCCACCUCCUAUUCUUG CACGAAACGGGAUCAAACAACCCCCUAGGAAUCACCUCCCAUUCCGAUAAAAUCACCUUC CACCCUUACUACACAAUCAAAGACGCCCUCGGCUUACUUCUCUUCCUUCUCUCCUUAAUG ACAUUAACACUAUUCUCACCAGACCUCCUAGGCGACCCAGACAAUUAUACCCUAGCCAAC CCCUUAAACACCCCUCCCCACAUCAAGCCCGAAUGAUAUUUCCUAUUCGCCUACACAAUU CUCCGAUCCGUCCCUAACAAACUAGGAGGCGUCCUUGCCCUAUUACUAUCCAUCCUCAUC CUAGCAAUAAUCCCCAUCCUCCAUAUAUCCAAACAACAAAGCAUAAUAUUUCGCCCACUA AGCCAAUCACUUUAUUGACUCCUAGCCGCAGACCUCCUCAUUCUAACCUGAAUCGGAGGA CAACCAGUAAGCUACCCUUUUACCAUCAUUGGACAAGUAGCAUCCGUACUAUACUUCACA ACAAUCCUAAUCCUAAUACCAACUAUCUCCCUAAUUGAAAACAAAAUACUCAAA >Bos_taurus AUGACUAACAUUCGAAAGUCCCACCCACUAAUAAAAAUUGUAAACAAUGCAUUCAUCGAC CUUCCAGCCCCAUCAAACAUUUCAUCAUGAUGAAAUUUCGGUUCCCUCCUGGGAAUCUGC CUAAUCCUACAAAUCCUCACAGGCCUAUUCCUAGCAAUACACUACACAUCCGACACAACA ACAGCAUUCUCCUCUGUUACCCAUAUCUGCCGAGACGUGAACUACGGCUGAAUCAUCCGA UACAUACACGCAAACGGAGCUUCAAUGUUUUUUAUCUGCUUAUAUAUGCACGUAGGACGA GGCUUAUAUUACGGGUCUUACACUUUUCUAGAAACAUGAAAUAUUGGAGUAAUCCUUCUG CUCACAGUAAUAGCCACAGCAUUUAUAGGAUACGUCCUACCAUGAGGACAAAUAUCAUUC UGAGGAGCAACAGUCAUCACCAACCUCUUAUCAGCAAUCCCAUACAUCGGCACAAAUUUA GUCGAAUGAAUCUGAGGCGGAUUCUCAGUAGACAAAGCAACCCUUACCCGAUUCUUCGCU UUCCAUUUUAUCCUUCCAUUUAUCAUCAUAGCAAUUGCCAUAGUCCACCUACUAUUCCUC CACGAAACAGGCUCCAACAACCCAACAGGAAUUUCCUCAGACGUAGACAAAAUCCCAUUC CACCCCUACUAUACCAUUAAGGACAUCUUAGGGGCCCUCUUACUAAUUCUAGCUCUAAUA CUACUAGUACUAUUCGCACCCGACCUCCUCGGAGACCCAGAUAACUACACCCCAGCCAAU CCACUCAACACACCCCCUCACAUCAAACCCGAGUGAUACUUCUUAUUUGCAUACGCAAUC UUACGAUCAAUCCCCAACAAACUAGGAGGAGUACUAGCCCUAGCCUUCUCUAUCCUAAUU CUUGCUCUAAUCCCCCUACUACACACCUCCAAACAACGAAGCAUAAUAUUCCGACCACUC AGCCAAUGCCUAUUCUGAGCCCUAGUAGCAGACCUACUGACACUCACAUGAAUUGGAGGA CAACCAGUCGAACACCCAUAUAUCACCAUCGGACAACUAGCAUCUGUCCUAUACUUUCUC CUCAUCCUAGUGCUAAUACCAACGGCCGGCACAAUCGAAAACAAAUUACUAAAAUGA >Balaenoptera_musculus AUGACCAACAUCCGAAAAACACACCCACUAAUAAAAAUCAUCAACGAUGCAUUCAUUGAU CUCCCUACCCCAUCAAACAUCUCCUCAUGAUGAAACUUCGGCUCCCUACUCGGCCUCUGC UUAAUUGUACAAAUCCUAACAGGCCUAUUCCUAGCAAUACACUAUACACCAGACACAAUA ACCGCCUUCUCAUCAGUCACACAUAUUUGCCGAGACGUAAACUAUGGCUGAGUUAUUCGG UACUUACAUGCAAACGGAGCCUCCAUAUUCUUCAUCUGCCUCUACGCCCACAUGGGACGA GGUCUAUACUACGGCUCCCACGCUUUUCGAGAAACAUGAAAUAUUGGAGUUAUUCUACUA UUCACGGUCAUAGCCACUGCAUUCGUAGGCUACGUCCUGCCCUGAGGACAAAUAUCAUUC UGAGGCGCAACCGUCAUCACCAACCUCCUAUCAGCAAUCCCAUACAUUGGUACUACCCUA GUCGAAUGAAUCUGAGGCGGUUUUUCUGUGGAUAAAGCAACACUAACACGCUUCUUUGCC UUCCACUUCAUUCUCCCCUUCAUCAUUAUAGCAUUAGCAAUCGUCCACCUCAUCUUCCUU CACGAAACAGGAUCCAACAACCCCACAGGUAUCCCAUCUGACAUAGAUAAAAUUCCAUUC CACCCCUACUACACAAUUAAAGACAUUCUAGGCGCCCUACUACUAAUCCUAACCCUACUA AUAUUAACUCUAUUUGCACCCGACUUACUCGGAGACCCAGACAACUACACCCCAGCAAAC CCACUCAGUACCCCAGCACACAUUAAACCAGAGUGAUAUUUCCUAUUUGCAUAUGCAAUC CUACGAUCAAUCCCCAACAAAUUAGGCGGAGUCUUAGCCCUACUACUCUCAAUCCUAGUC CUAGCUCUAAUCCCAAUACUCCACACAUCCAAACAACGAAGCAUAAUAUUCCGACCCUUU AGCCAAUUCCUGUUUUGAGUACUGGUCGCAGACCUACUCACCCUAACGUGGAUCGGCGGC CAACCCGUAGAACACCCCUAUGUAAUUGUAGGCCAACUCGCAUCCAUCCUCUACUUCCUC UUAAUUCUAGUGUUAAUACCAGUAACUAGUCUUAUCGAAAAUAAACUUAUAAAAUGA >Pongo_pygmaeus AUGACCCCAAUACGCAAAACCAACCCACUAAUAAAAUUAAUUAACCACUCACUCAUCGAC CUCCCCACCCCAUCAAACAUCUCUGCAUGAUGGAACUUCGGCUCACUUCUAGGCGCCUGC UUAAUCAUCCAAACCAUCACUGGACUAUUCCUAGCCAUACAUUACUCACCAGACGCCACU ACCGCCUUUUCAUCAAUCGCCCAUAUUACUCGAGAUGUAAACUACGGCUGAAUAAUCCGC CACCUUCACGCUAACGGCGCCUCAAUGCUCUUUAUCUGCCUCUUCCUACACAUUGGCCGA GGCUUAUACUAUGGCUCAUUCACCCACUUAGAAACCUGAAACAUUGGUAUUAUCCUACUG UUUAUAACCAUAAUAACAGCCUUCAUAGGCUACGUCCUCCCAUGAGGCCAAAUAUCCUUC UGAGGAGCCACAGUAAUUACAAACCUAUUAUCCGCCGUCCCAUACAUUGGAACAGACCUA GUCCAAUGGGUCUGAGGGGGCUACUCAGUAAAUAGCCCCACUCUAACACGAUUCUUUACC CUUCACUUCAUACUACCUUUCAUCAUUACAGCUCUAACAACCCUUCACCUCCUAUUCCUU CACGAAACAGGAUCAAAUAACCCCCUGGGAAUCCCCUCCCACUCCGAUAAAAUCACUUUC CACCCCUACUAUACAAUUAAAGACAUCCUAGGCCUACUCCUUUUUCUCCUCGCCCUAAUA ACAUUAACACUACUCUCACCAGACCUCCUAAGCGACCCAGACAACUACACCUUAGCUAAC CCCCUAAGCACCCCACCCCACAUUAAGCCCGAAUGAUACUUCCUAUUCGCCUACGCAAUC CUACGAUCCGUCCCCAACAAACUAGGAGGUGUAAUAGCCCUCAUGCUAUCUAUCCUAAUC CUAACAACAAUCCCCGCUCUCCACACAUCCAAGCAACAGAGCAUAACAUUCCGCCCAUUA AGCCAAUUCCUAUACUGACUCUUAAUCACCGACCUCCUAGUUCUCACCUGAAUUGGAGGA CAACCAGUAAGCUACCCCUUUAUUACUAUUGGCCAAGUAGCAUCCGUACUAUACUUUACC ACUAUCCUACUCCUUAUACCAACCUCUUCCCUGAUCGAAAACUACAUACUCAAAUGAACC >Pan_troglodytes AUGACCCCGACACGCAAAAUUAACCCACUAAUAAAAUUAAUUAAUCACUCAUUUAUCGAC CUCCCCACCCCAUCCAACAUUUCCGCAUGAUGGAACUUCGGCUCACUUCUCGGCGCCUGC CUAAUCCUUCAAAUUACCACAGGAUUAUUCCUAGCUAUACACUACUCACCAGACGCCUCA ACCGCCUUCUCGUCGAUCGCCCACAUCACCCGAGACGUAAACUAUGGUUGGAUCAUCCGC UACCUCCACGCUAACGGCGCCUCAAUAUUUUUUAUCUGCCUCUUCCUACACAUCGGCCGA GGUCUAUAUUACGGCUCAUUUCUCUACCUAGAAACCUGAAACAUUGGCAUUAUCCUCUUG CUCACAACCAUAGCAACAGCCUUUAUGGGCUAUGUCCUCCCAUGAGGCCAAAUAUCCUUC UGAGGAGCCACAGUAAUUACAAACCUACUGUCCGCUAUCCCAUACAUCGGAACAGACCUG GUCCAGUGAGUCUGAGGAGGCUACUCAGUAGACAGCCCUACCCUUACACGAUUCUUCACC UUCCACUUUAUCUUACCCUUCAUCAUCACAGCCCUAACAACACUUCAUCUCCUAUUCUUA CACGAAACAGGAUCAAAUAACCCCCUAGGAAUCACCUCCCACUCCGACAAAAUUACCUUC CACCCCUACUACACAAUCAAAGAUAUCCUUGGCUUAUUCCUUUUCCUCCUUAUCCUAAUG ACAUUAACACUAUUCUCACCAGGCCUCCUAGGCGAUCCAGACAACUAUACCCUAGCUAAC CCCCUAAACACCCCACCCCACAUUAAACCCGAGUGAUACUUUCUAUUUGCCUACACAAUC CUCCGAUCCAUCCCCAACAAACUAGGAGGCGUCCUCGCCCUACUACUAUCUAUCCUAAUC CUAACAGCAAUCCCUGUCCUCCACACAUCCAAACAACAAAGCAUAAUAUUUCGCCCACUA AGCCAACUGCUUUACUGACUCCUAGCCACAGACCUCCUCAUCCUAACCUGAAUCGGAGGA CAACCAGUAAGCUACCCCUUCAUCACCAUCGGACAAAUAGCAUCCGUAUUAUACUUCACA ACAAUCCUAAUCCUAAUACCAAUCGCCUCUCUAAUCGAAAACAAAAUACUUGAAUGAACC >Gallus_gallus AUGGCACCCAACAUUCGAAAAUCCCACCCCCUACUAAAAAUAAUUAACAACUCCCUAAUC GACCUCCCAGCCCCAUCCAACAUCUCUGCUUGAUGAAAUUUCGGCUCCCUAUUAGCAGUC UGCCUCAUGACCCAAAUCCUCACCGGCCUACUACUAGCCAUGCACUACACAGCAGACACA UCCCUAGCCUUCUCCUCCGUAGCCCACACUUGCCGGAACGUACAAUACGGCUGACUCAUC CGGAAUCUCCACGCAAACGGCGCCUCAUUCUUCUUCAUCUGUAUCUUCCUUCACAUCGGA CGAGGCCUAUACUACGGCUCCUACCUCUACAAGGAAACCUGAAACACAGGAGUAAUCCUC CUCCUCACACUCAUAGCCACCGCCUUUGUGGGCUAUGUUCUCCCAUGGGGCCAAAUAUCA UUCUGAGGGGCCACCGUUAUCACAAACCUAUUCUCAGCAAUUCCCUACAUUGGACACACC CUAGUAGAGUGAGCCUGAGGGGGAUUCUCAGUCGACAACCCAACCCUUACCCGAUUCUUC GCCUUACACUUCCUCCUCCCCUUUGCAAUCGCAGGUAUUACUAUCAUCCACCUCACCUUC CUACACGAAUCAGGCUCAAACAACCCCCUAGGCAUCUCAUCCGACUCUGACAAAAUUCCA UUUCACCCAUACUACUCCUUCAAAGACAUUCUGGGCUUAACUCUCAUACUCACCCCAUUC CUAACACUAGCCCUAUUCUCCCCCAACCUCCUAGGAGACCCAGAAAACUUCACCCCAGCA AACCCACUAGUAACCCCCCCACAUAUCAAACCAGAAUGAUAUUUUCUAUUCGCCUAUGCC AUCCUACGCUCCAUCCCCAACAAACUUGGAGGUGUACUAGCCCUAGCAGCCUCAGUCCUC AUCCUCUUCCUAAUCCCCUUCCUCCACAAAUCUAAACAACGAACAAUAACCUUCCGACCA CUCUCCCAAACCUUAUUCUGACUUCUAGUAGCCAACCUUCUUAUCCUAACCUGAAUCGGA AGCCAACCAGUAGAACACCCCUUCAUCAUCAUUGGCCAAAUAGCAUCCCUCUCUUACUUC ACCAUCCUACUUAUCCUCUUCCCCACAAUCGGAACACUAGAAAACAAAAUACUCAACUAC >Alligator_mississippiensis AUGACCCACCAACUACGAAAAUCCCACCCAAUCAUUAAACUCAUCAACCGCUCCCUAAUU GACCUACCAACACCCUCAAACAUCUCCGCUUGAUGAAACUUUGGAUCACUACUAGGCCUA ACCCUAUUAAUUCAGAUUCUAACAGGAUUCUUCUUAAUAAUGCACUUUUCAUCAAGCGAU ACUCUAGCAUUUUCAUCUGUAUCCUACACCUCCCGCGAAGUCUGAUUUGGAUGACUCAUC CGCAACCUCCACACAAAUGGGGCCUCCCUGUUCUUUAUAUUUAUCUUUCUUCACAUCGGA CGAGGCCUAUACUACACAUCAUAUCUUCACGAAAGCACAUGAAAUAUUGGAGUAAUCAUA CUUCUACUCCUAAUAGCCACAGCAUUUAUAGGCUAUGUUCUCCCAUGAGGACAAAUAUCA UUCUGAGGAGCAACCGUAAUCACGAAUCUACUUUCUGCCACACCCUACGUUGGAAGCACU GUCGUGCCAUGAAUUUGAGGCGGCCCCUCUGUUGACAACGCAACACUUACACGCUUCACU GCCCUACACUUCCUCCUUCCAUUCGCCCUAUUGGCUUCACUCAUCACCCACCUGAUCUUC CUCCAUGAACGAGGAUCAUUUAACCCCCUAGGAAUUAGCCCAAAUGCUGACAAAAUCCCA UUCCACCCCUACUUCACCAUAAAAGACGCCCUAGGAGCAGCACUAGCUGCCUCCUCACUA CUCAUCUUAGCUCUCUACCUACCAGCCCUAUUAGGGGACCCUGAAAACUUCACCCCAGCA AAUUCCAUAAUUACCCCAACACACAUCAAACCCGAAUGGUACUUCCUAUUUGCUUAUGCC AUUCUACGAUCUAUUCCAAAUAAGUUAGGAGGAGUACUAGCAAUAUUCUCAUCCAUUUUA GUCCUAUUCCUAAUACCCGCCCUACACACAGCAAAACAACAACCAAUAUCAAUACGCCCU AUAUCUCAGCUUCUAUUUUGAGCCCUUACCCUGGACUUCCUCUUACUCACAUGAAUCGGA GGCCAACCAGUAAACCCCCCAUAUAUUUUAAUUGGCCAAACUGCCUCCCUAUUCUACUUC AUCAUCAUCCUAAUCCUCAUACCAAUAGCAGGCCUCUUAGAGAACAAAAUAGUUGAACCC ACCUAUGUUACCCCUAAG You can also download this multifasta file HERE . The tsv file with the NCBI taxonomy ID (TxID) can be obtained HERE . Later, we are going to use this file to annotate the tree using TaxOnTree . This step is very useful, especially if you are not familiar with the complete taxonomic classification of the OTUs you are currently working. The next step on this tutorial is to align these sequences to get our dataset ready. Since these sequences are not difficult to align, we can use the Clustal program. You can use either the installed programs Jalview or MEGAX. In this example, we'll show the alignment steps using Jalview. MEGAX also aligns nucleotides and proteins sequences, using the programs Clustal or Muscle. If you want to use MEGA for the alignment, I recommend you to use Clustal program. Steps: Open Jalview. Close all example windows. Open the multifasta file, following the menu, shown in the figure below: Then, put some color in the alignment, using the following options: After that, you can start the alignment process, using Clustal, as demonstrated in the figure below: The aligned sequences will appear right after the job is done. Again, put some color and inspect the alignment. Now we're going to save this alignment. However, first, we have to change some options in Jalview. In Jalview main window, go to the menu Tools and after that, press Preferences . The following window will appear: Press the right arrow until you find the Output options. Make sure the options are the same as the above figure. Press OK . After that, you can save your alignment, following the menu File > Save as... Save your alignment in fasta format. If you want the exported alignment to show the start-end sites for each sequence, you do not need to execute the above steps. However, keep in mind that this information can (and in most cases, will) bring incompatibilities with some programs and tools.","title":"2nd Part - Sequence Alignment"},{"location":"IQTree/","text":"Using IQ-Tree Introduction IQ-TREE is relatively recent (2014) open-source software package for phylogenetic inference using the maximum likelihood (ML) criterion. It has a very good performance when compared with other popular ML phylogenetics software such as RAxML and PhyML, and it has been playing a vital role as an integral component for many platforms such as Nextstrain (Minh et al. 2020). According to this latter publication: The high performance of IQ-TREE results from the efficient integration of novel phylogenetic methods that improve the three key steps in phylogenetic analysis: fast model selection via ModelFinder, an effective tree search algorithm, and a novel ultrafast bootstrap approximation. IQ-Tree is also good for phylogenomics analyzes, since it t also finds the best-fit partitioning scheme for your dataset, allowing complex models for mixed data types, mixed rate heterogeneity types, linked or unlinked branch lengths. In addition, its fast Maximum Likelihood and bootstraps implementations make this application a must have in phylogenetics hypothesis testing. The Tutorial The IQ-Tree site has a very good beginner tutorial, which we are going to use on this course. The tutorial can accessed by the following link: http://www.iqtree.org/workshop/sydney2022 We can also use the Web Server tutorial described by the following link: http://www.iqtree.org/doc/Web-Server-Tutorial Documentation IQ-Tree has a very thoroughly manual, which describes how to perform since simple tasks, like changing sequence formats, to apply complex models to phylogenomics datasets. Please find bellow the direct link for the IQ-Tree manual: - http://www.iqtree.org/doc/iqtree-doc.pdf IQ-TREE has an extensive documentation with several tutorials and manual (copied from IQ-Tree website): Getting started guide: recommended for users who just downloaded IQ-TREE. Web Server Tutorial: A quick starting guide for the IQ-TREE Web Server. Beginner's tutorial: recommended for users starting to use IQ-TREE. Advanced tutorial: recommended for more experienced users who want to explore more features of IQ-TREE. Command Reference: Comprehensive documentation of command-line options available in IQ-TREE. Substitution Models: All common substitution models and usages. Complex Models: Complex models such as partition and mixture models. Polymorphism Aware Models: Polymorphism-aware phylogenetic Models (PoMo) related documentation. Compilation guide: for advanced users who wants to compile IQ-TREE from source code. Frequently asked questions (FAQ): recommended to have a look before you post a question in the IQ-TREE group.","title":"Using IQ-Tree"},{"location":"IQTree/#using-iq-tree","text":"","title":"Using IQ-Tree"},{"location":"IQTree/#introduction","text":"IQ-TREE is relatively recent (2014) open-source software package for phylogenetic inference using the maximum likelihood (ML) criterion. It has a very good performance when compared with other popular ML phylogenetics software such as RAxML and PhyML, and it has been playing a vital role as an integral component for many platforms such as Nextstrain (Minh et al. 2020). According to this latter publication: The high performance of IQ-TREE results from the efficient integration of novel phylogenetic methods that improve the three key steps in phylogenetic analysis: fast model selection via ModelFinder, an effective tree search algorithm, and a novel ultrafast bootstrap approximation. IQ-Tree is also good for phylogenomics analyzes, since it t also finds the best-fit partitioning scheme for your dataset, allowing complex models for mixed data types, mixed rate heterogeneity types, linked or unlinked branch lengths. In addition, its fast Maximum Likelihood and bootstraps implementations make this application a must have in phylogenetics hypothesis testing.","title":"Introduction"},{"location":"IQTree/#the-tutorial","text":"The IQ-Tree site has a very good beginner tutorial, which we are going to use on this course. The tutorial can accessed by the following link: http://www.iqtree.org/workshop/sydney2022 We can also use the Web Server tutorial described by the following link: http://www.iqtree.org/doc/Web-Server-Tutorial","title":"The Tutorial"},{"location":"IQTree/#documentation","text":"IQ-Tree has a very thoroughly manual, which describes how to perform since simple tasks, like changing sequence formats, to apply complex models to phylogenomics datasets. Please find bellow the direct link for the IQ-Tree manual: - http://www.iqtree.org/doc/iqtree-doc.pdf IQ-TREE has an extensive documentation with several tutorials and manual (copied from IQ-Tree website): Getting started guide: recommended for users who just downloaded IQ-TREE. Web Server Tutorial: A quick starting guide for the IQ-TREE Web Server. Beginner's tutorial: recommended for users starting to use IQ-TREE. Advanced tutorial: recommended for more experienced users who want to explore more features of IQ-TREE. Command Reference: Comprehensive documentation of command-line options available in IQ-TREE. Substitution Models: All common substitution models and usages. Complex Models: Complex models such as partition and mixture models. Polymorphism Aware Models: Polymorphism-aware phylogenetic Models (PoMo) related documentation. Compilation guide: for advanced users who wants to compile IQ-TREE from source code. Frequently asked questions (FAQ): recommended to have a look before you post a question in the IQ-TREE group.","title":"Documentation"},{"location":"MEGAX_ENG/","text":"Inferring Phylogenies using MEGAX A crash course . Now we're going to use this dataset to construct the phylogenetic trees. For this we will use MEGAX. Open the alignment. In the next window, click in Analyze as DAMBE (protein coding nucleotide sequences and the genetic code). Test of the nucleotide substitution model. The test of nucleotide substitution model sometimes gives as result models which are not present in MEGA options. In these cases, you have to choose a model that has the necessary parameters suitable to represent your sequence alignment. Although highly recommended, especially for beginners in phylogenetic analyses, this test is not critical. Examine the alignment statistics. Click in the TA icon on the right, to launch the Data Explorer. Construct a Neighbor-joining Phylogenetic tree, with a bootstrap test. Use Complete deletion on this dataset. You can use Tamura-Nei 93, since GTR model does not exist for the Neighbor-Joining method. Don't forget to examine the gamma-shape parameter for the TN93 model and the proportion of invariant sites (if needed). Construct a phylogenetic tree using Parsimony and also Maximum Likelihood. For the later, you can use the GTR model (General Time-reversible), selected by the test of the nucleotide substitution model. Also use Complete deletion on both methods. In the ML method, you don't need to adjust a specific gamma-shape parameter, you just have to set to use Gamma Do not forget to root the trees when necessary and to save the trees. The tree demonstrated below is not rooted with the most plausible outgroup! Exercise: Which species do you choose to be the outgroup of the above dataset? Explain. Compare the obtained trees and explain the phylogeny, always looking for supporting (or not) bootstrap values.","title":"Using MEGAX"},{"location":"MEGAX_ENG/#inferring-phylogenies-using-megax","text":"A crash course . Now we're going to use this dataset to construct the phylogenetic trees. For this we will use MEGAX. Open the alignment. In the next window, click in Analyze as DAMBE (protein coding nucleotide sequences and the genetic code). Test of the nucleotide substitution model. The test of nucleotide substitution model sometimes gives as result models which are not present in MEGA options. In these cases, you have to choose a model that has the necessary parameters suitable to represent your sequence alignment. Although highly recommended, especially for beginners in phylogenetic analyses, this test is not critical. Examine the alignment statistics. Click in the TA icon on the right, to launch the Data Explorer. Construct a Neighbor-joining Phylogenetic tree, with a bootstrap test. Use Complete deletion on this dataset. You can use Tamura-Nei 93, since GTR model does not exist for the Neighbor-Joining method. Don't forget to examine the gamma-shape parameter for the TN93 model and the proportion of invariant sites (if needed). Construct a phylogenetic tree using Parsimony and also Maximum Likelihood. For the later, you can use the GTR model (General Time-reversible), selected by the test of the nucleotide substitution model. Also use Complete deletion on both methods. In the ML method, you don't need to adjust a specific gamma-shape parameter, you just have to set to use Gamma Do not forget to root the trees when necessary and to save the trees. The tree demonstrated below is not rooted with the most plausible outgroup!","title":"Inferring Phylogenies using MEGAX"},{"location":"MEGAX_ENG/#exercise","text":"Which species do you choose to be the outgroup of the above dataset? Explain. Compare the obtained trees and explain the phylogeny, always looking for supporting (or not) bootstrap values.","title":"Exercise:"},{"location":"Material/","text":"Files Working Datasets Tree Files for use in FigTree: Tree File Tree File 2 Datasets for multiple sequence alignment: primatesNuc_1.fasta primatesAA_1.fasta For use in the analysis of substitution saturation: VertCOI.fas InvertebrateEF1a.fas SIV.fas Selection tests Data I.zip Additional tutorial. For use in the BEAST+EBSP tutorial: Tutorial_Zika_Filogenia.zip Programs, Applications and Tools MEGAX DAMBE Bioedit gedit jModelTest Prottest 3 ModelTest-ng BEAST2 BEAST 1.8 Clustal X PAMLX R Aliview FigTree Jalview TrimAL Online Tools TaxOnTree Comparative and exploratory phylogeny, as well as phylogenetic trees annottion. T-Coffee Alignment program. Several options depending on your dataset. Phylemon2 Site with on line phylogenetics tools and pipelines. There, you can use TrimAL to \"clean\" gappy alignments. DataMonkey Several tools used in selection tests, recombination and gene conversion detection. Pseudochecker A tool to infer eukaryotic nuclear protein-coding genes inactivation. CIPRES Public portal containing pipelines for inferring phylogenies. Additional Links TimeTree Phylogeny.fr Nextstrain GSAID Virus Variation BEAST 1.X Tutorials BEAST 2.X Tutorials References Anisimova M, Liberles DA, Philippe H, Provan J, Pupko T, Haeseler von A. State-of the art methodologies dictate new standards for phylogenetic analysis. BMC Evol Biol. 2013;13(1):1-1. doi:10.1186/1471-2148-13-161. Higgs, P.G.; Attwood, T.K. Bioinformatics and Molecular Evolution.. Malden (Massachusetts): Blackwell Publishing. 2005. Bouckaert, R. et al. BEAST 2: A Software Platform for Bayesian Evolutionary Analysis. PLoS Computational Biology, v. 10, n. 4, p. e1003537, 10 abr. 2014. Choudhuri S. Bioinformatics for Beginners: Genes, Genomes, Molecular Evolution, Databases and Analytical Tools. Elsevier, 2014. Cvrckova F. A plant biologists\u2019 guide to phylogenetic analysis of biological macromolecule sequences. Biologia Plantarum. 2016;60(4):619-627. Dickinson H, Costa L, Gutierrez-Marcos J. Epigenetic neofunctionalisation and regulatory gene evolution in grasses. Trends in Plant Science. 2012;17(7):389-394. Do CB, Katoh K. Protein Multiple Sequence Alignment. Thompson JD, Schaeffer-Reiss C, Ueffing M, eds. 2008:379-413. doi:10.1007/978-1-59745-398-1_25. Drummond, A. J. et al. Bayesian coalescent inference of past population dynamics from molecular sequences. Molecular Biology and Evolution, v. 22, p. 1185\u20131192, 2005. Edgar RC, Batzoglou S. Multiple sequence alignment. Current Opinion in Structural Biology. 2006;16(3):368-373. doi:10.1016/j.sbi.2006.04.004. Faria, N. R. et al. Zika virus in the Americas: Early epidemiological and genetic findings. Science (New York, N.Y.), v. 5036, n. March, p. aaf5036, 2016. Futuyma DJ. Evolution. Sunderland, Massachusetts, USA.: Sinauer Associates; 2nd Edition. 2009. Gardner PP. A benchmark of multiple sequence alignment programs upon structural RNAs. Nucleic Acids Research. 2005;33(8):2433-2439. doi:10.1093/nar/gki541. Gibas, c. & jambeck, P. Developing Bioinformatics Computer Skills. O \u0301Reilly & Associates, Inc. USA. 2001. Graur, d. & Li, W. H. Fundamentals of Molecular Evolution. 2a edi\u00e7\u00e3o. Sinauer Press, Sunderland, Massachusetts. 2000. 481p. Hedges, S. B.; Kumar, S. (Eds). The timetree of life. Oxford University Press, New York. 2009. Higgins, D., Lemey, P.. Multiple sequence alignment. In Lemey, P., Salemi, M., Vandamme, A. (eds.). The Phylogenetic Handbook: a Practical Approach to Phylogenetic Analysis and Hypothesis Testing, Published by Cambridge University Press. Cambridge University Press 2009. Ho, S. Y. W.; Shapiro, B. Skyline-plot methods for estimating demographic history from nucleotide sequences. Molecular Ecology Resources, v. 11, p. 423\u2013434, 2011. Judd, W. S.; Campbell, C. S. & Stevens, P. F. Plant Systematics: A Phylogenetic Approach. Sinauer Associates, Inc. Publishers. Sunderland, MA, USA. 1999. 576p. Kumar S, Stecher G, Tamura K. MEGA7: Molecular Evolutionary Genetics Analysis Version 7.0 for Bigger Datasets. Molecular Biology and Evolution. 2016;33(7):1870-1874. doi:10.1093/molbev/msw054. Kuraku S, Feiner N, Keeley SD, Hara Y. Incorporating tree-thinking and evolutionary time scale into developmental biology. HANASHIMA C, NISHIMURA T, NAKAMURA H, STERN C, eds. Develop Growth Differ. 2016;58(1):131-142. doi:10.1111/dgd.12258. Lemey, P., Posada, D. S. Molecular clock analysis. In Lemey, P., Salemi, M., Vandamme, A. (eds.). The Phylogenetic Handbook: a Practical Approach to Phylogenetic Analysis and Hypothesis Testing, Published by Cambridge University Press. Cambridge University Press 2009. Lu\u00eds Q Alves, Raquel Ruivo, Miguel M Fonseca, M\u00f3nica Lopes-Marques, Pedro Ribeiro, L Filipe C Castro, Pseudo Checker : an integrated online platform for gene inactivation inference, Nucleic Acids Research , Volume 48, Issue W1, 02 July 2020, Pages W321\u2013W331, https://doi.org/10.1093/nar/gkaa408 Mayr, E. O Desenvolvimento do Pensamento Biol\u00f3gico: Diversidade, Evolu\u00e7\u00e3o e Heran\u00e7a. Editora UnB. Universidade de Bras\u00edlia. 1998. 1007p. Morrison DA. L. A. S. JOHNSON REVIEW No. 8. Multiple sequence alignment for phylogenetic purposes. Aust Systematic Bot. 2006;19(6):479. doi:10.1071/SB06020. Nei, M. & Kumar, S. Molecular Evolution and Phylogenetics. Oxford University Press, Inc. 2001. 333p. Omland KE, Cook LG, Crisp MD. Tree thinking for all biology: the problem with reading phylogenies as ladders of progress. Bioessays. 2008;30(9):854-867. doi:10.1002/bies.20794. Page, R. D. M. & Holmes, E. C. Molecular Evolution: A phylogenetic approach. Blackwell Science. 2001. 346 pp. Kolekar, P., Kale, M., Kulkarni-Kale, U. (2011). Molecular Evolution & Phylogeny: What, When, Why & How?, Computational Biology and Applied Bioinformatics, Prof. Heitor Lopes (Ed.), InTech, DOI: 10.5772/20225. Pond, S. L. K., Poon, A. F. Y., Frost, S. D. W. Estimating selection pressures on alignments of coding sequences. In Lemey, P., Salemi, M., Vandamme, A. (eds.). The Phylogenetic Handbook: a Practical Approach to Phylogenetic Analysis and Hypothesis Testing, Published by Cambridge University Press. Cambridge University Press 2009. Posada, D. & Crandall, K. A. ModelTest: Testing the model of DNA substitution. Bioinformatics v. 14, n. 9, p. 817-818. 1998. Posada, D. Selecting models of evolution. In Lemey, P., Salemi, M., Vandamme, A. (eds.). The Phylogenetic Handbook: a Practical Approach to Phylogenetic Analysis and Hypothesis Testing, Published by Cambridge University Press. Cambridge University Press 2009. Rieppel, O.: The series, the network, and the tree: changing metaphors of order in nature. - Biol. Phil. 25: 475-496, 2010. Russo, C. A. de M., Miyaki, C. Y. & Pereira, S. L. Reconstru\u00e7\u00e3o Filogen\u00e9tica. M\u00e9todos Geom\u00e9tricos. In: Matioli, S. R. (ed.) Biologia Molecular e Evolu\u00e7\u00e3o. p. 108 -116. Holos editora. Ribeir\u00e3o Preto, SP. 2001. Sakamoto, T., Ortega, J.M. TaxOnTree: a tool that generates trees annotated with taxonomic information. bioRxiv 2020. DOI: 10.1101/2020.12.24.424364 . Sttebins, G. L. Processos de Evolu\u00e7\u00e3o Org\u00e2nica. Editora Pol\u00edgono e Editora da Universidade de S\u00e3o Paulo. S\u00e3o Paulo. 1970. 253p. Van de Peer, Y. Phylogenetic inference based on distance methods. In - Lemey, P., Salemi, M., Vandamme, A. (eds.). The Phylogenetic Handbook: a Practical Approach to Phylogenetic Analysis and Hypothesis Testing, Published by Cambridge University Press. Cambridge University Press 2009. Xia X. DAMBE6: New Tools for Microbial Genomics, Phylogenetics, and Molecular Evolution. Journal of Heredity. 2017;108(4):431-437. doi:10.1093/jhered/esx033. Xia, X. 2000. Data Analysis in Molecular Biology and Evolution. Kluwer Academic Publishers. Xia, X. Assessing substitution saturation with Dambe. In Lemey, P., Salemi, M., Vandamme, A. (eds.). The Phylogenetic Handbook: a Practical Approach to Phylogenetic Analysis and Hypothesis Testing, Published by Cambridge University Press. Cambridge University Press 2009. Yang Z, Rannala B. Molecular phylogenetics: principles and practice. Nature Review Genetics. 2012;13(303):1-12. doi:10.1038/nrg3186.","title":"Files and References"},{"location":"Material/#files","text":"","title":"Files"},{"location":"Material/#working-datasets","text":"Tree Files for use in FigTree: Tree File Tree File 2 Datasets for multiple sequence alignment: primatesNuc_1.fasta primatesAA_1.fasta For use in the analysis of substitution saturation: VertCOI.fas InvertebrateEF1a.fas SIV.fas Selection tests Data I.zip Additional tutorial. For use in the BEAST+EBSP tutorial: Tutorial_Zika_Filogenia.zip","title":"Working Datasets"},{"location":"Material/#programs-applications-and-tools","text":"MEGAX DAMBE Bioedit gedit jModelTest Prottest 3 ModelTest-ng BEAST2 BEAST 1.8 Clustal X PAMLX R Aliview FigTree Jalview TrimAL","title":"Programs, Applications and Tools"},{"location":"Material/#online-tools","text":"TaxOnTree Comparative and exploratory phylogeny, as well as phylogenetic trees annottion. T-Coffee Alignment program. Several options depending on your dataset. Phylemon2 Site with on line phylogenetics tools and pipelines. There, you can use TrimAL to \"clean\" gappy alignments. DataMonkey Several tools used in selection tests, recombination and gene conversion detection. Pseudochecker A tool to infer eukaryotic nuclear protein-coding genes inactivation. CIPRES Public portal containing pipelines for inferring phylogenies.","title":"Online Tools"},{"location":"Material/#additional-links","text":"TimeTree Phylogeny.fr Nextstrain GSAID Virus Variation BEAST 1.X Tutorials BEAST 2.X Tutorials","title":"Additional Links"},{"location":"Material/#references","text":"Anisimova M, Liberles DA, Philippe H, Provan J, Pupko T, Haeseler von A. State-of the art methodologies dictate new standards for phylogenetic analysis. BMC Evol Biol. 2013;13(1):1-1. doi:10.1186/1471-2148-13-161. Higgs, P.G.; Attwood, T.K. Bioinformatics and Molecular Evolution.. Malden (Massachusetts): Blackwell Publishing. 2005. Bouckaert, R. et al. BEAST 2: A Software Platform for Bayesian Evolutionary Analysis. PLoS Computational Biology, v. 10, n. 4, p. e1003537, 10 abr. 2014. Choudhuri S. Bioinformatics for Beginners: Genes, Genomes, Molecular Evolution, Databases and Analytical Tools. Elsevier, 2014. Cvrckova F. A plant biologists\u2019 guide to phylogenetic analysis of biological macromolecule sequences. Biologia Plantarum. 2016;60(4):619-627. Dickinson H, Costa L, Gutierrez-Marcos J. Epigenetic neofunctionalisation and regulatory gene evolution in grasses. Trends in Plant Science. 2012;17(7):389-394. Do CB, Katoh K. Protein Multiple Sequence Alignment. Thompson JD, Schaeffer-Reiss C, Ueffing M, eds. 2008:379-413. doi:10.1007/978-1-59745-398-1_25. Drummond, A. J. et al. Bayesian coalescent inference of past population dynamics from molecular sequences. Molecular Biology and Evolution, v. 22, p. 1185\u20131192, 2005. Edgar RC, Batzoglou S. Multiple sequence alignment. Current Opinion in Structural Biology. 2006;16(3):368-373. doi:10.1016/j.sbi.2006.04.004. Faria, N. R. et al. Zika virus in the Americas: Early epidemiological and genetic findings. Science (New York, N.Y.), v. 5036, n. March, p. aaf5036, 2016. Futuyma DJ. Evolution. Sunderland, Massachusetts, USA.: Sinauer Associates; 2nd Edition. 2009. Gardner PP. A benchmark of multiple sequence alignment programs upon structural RNAs. Nucleic Acids Research. 2005;33(8):2433-2439. doi:10.1093/nar/gki541. Gibas, c. & jambeck, P. Developing Bioinformatics Computer Skills. O \u0301Reilly & Associates, Inc. USA. 2001. Graur, d. & Li, W. H. Fundamentals of Molecular Evolution. 2a edi\u00e7\u00e3o. Sinauer Press, Sunderland, Massachusetts. 2000. 481p. Hedges, S. B.; Kumar, S. (Eds). The timetree of life. Oxford University Press, New York. 2009. Higgins, D., Lemey, P.. Multiple sequence alignment. In Lemey, P., Salemi, M., Vandamme, A. (eds.). The Phylogenetic Handbook: a Practical Approach to Phylogenetic Analysis and Hypothesis Testing, Published by Cambridge University Press. Cambridge University Press 2009. Ho, S. Y. W.; Shapiro, B. Skyline-plot methods for estimating demographic history from nucleotide sequences. Molecular Ecology Resources, v. 11, p. 423\u2013434, 2011. Judd, W. S.; Campbell, C. S. & Stevens, P. F. Plant Systematics: A Phylogenetic Approach. Sinauer Associates, Inc. Publishers. Sunderland, MA, USA. 1999. 576p. Kumar S, Stecher G, Tamura K. MEGA7: Molecular Evolutionary Genetics Analysis Version 7.0 for Bigger Datasets. Molecular Biology and Evolution. 2016;33(7):1870-1874. doi:10.1093/molbev/msw054. Kuraku S, Feiner N, Keeley SD, Hara Y. Incorporating tree-thinking and evolutionary time scale into developmental biology. HANASHIMA C, NISHIMURA T, NAKAMURA H, STERN C, eds. Develop Growth Differ. 2016;58(1):131-142. doi:10.1111/dgd.12258. Lemey, P., Posada, D. S. Molecular clock analysis. In Lemey, P., Salemi, M., Vandamme, A. (eds.). The Phylogenetic Handbook: a Practical Approach to Phylogenetic Analysis and Hypothesis Testing, Published by Cambridge University Press. Cambridge University Press 2009. Lu\u00eds Q Alves, Raquel Ruivo, Miguel M Fonseca, M\u00f3nica Lopes-Marques, Pedro Ribeiro, L Filipe C Castro, Pseudo Checker : an integrated online platform for gene inactivation inference, Nucleic Acids Research , Volume 48, Issue W1, 02 July 2020, Pages W321\u2013W331, https://doi.org/10.1093/nar/gkaa408 Mayr, E. O Desenvolvimento do Pensamento Biol\u00f3gico: Diversidade, Evolu\u00e7\u00e3o e Heran\u00e7a. Editora UnB. Universidade de Bras\u00edlia. 1998. 1007p. Morrison DA. L. A. S. JOHNSON REVIEW No. 8. Multiple sequence alignment for phylogenetic purposes. Aust Systematic Bot. 2006;19(6):479. doi:10.1071/SB06020. Nei, M. & Kumar, S. Molecular Evolution and Phylogenetics. Oxford University Press, Inc. 2001. 333p. Omland KE, Cook LG, Crisp MD. Tree thinking for all biology: the problem with reading phylogenies as ladders of progress. Bioessays. 2008;30(9):854-867. doi:10.1002/bies.20794. Page, R. D. M. & Holmes, E. C. Molecular Evolution: A phylogenetic approach. Blackwell Science. 2001. 346 pp. Kolekar, P., Kale, M., Kulkarni-Kale, U. (2011). Molecular Evolution & Phylogeny: What, When, Why & How?, Computational Biology and Applied Bioinformatics, Prof. Heitor Lopes (Ed.), InTech, DOI: 10.5772/20225. Pond, S. L. K., Poon, A. F. Y., Frost, S. D. W. Estimating selection pressures on alignments of coding sequences. In Lemey, P., Salemi, M., Vandamme, A. (eds.). The Phylogenetic Handbook: a Practical Approach to Phylogenetic Analysis and Hypothesis Testing, Published by Cambridge University Press. Cambridge University Press 2009. Posada, D. & Crandall, K. A. ModelTest: Testing the model of DNA substitution. Bioinformatics v. 14, n. 9, p. 817-818. 1998. Posada, D. Selecting models of evolution. In Lemey, P., Salemi, M., Vandamme, A. (eds.). The Phylogenetic Handbook: a Practical Approach to Phylogenetic Analysis and Hypothesis Testing, Published by Cambridge University Press. Cambridge University Press 2009. Rieppel, O.: The series, the network, and the tree: changing metaphors of order in nature. - Biol. Phil. 25: 475-496, 2010. Russo, C. A. de M., Miyaki, C. Y. & Pereira, S. L. Reconstru\u00e7\u00e3o Filogen\u00e9tica. M\u00e9todos Geom\u00e9tricos. In: Matioli, S. R. (ed.) Biologia Molecular e Evolu\u00e7\u00e3o. p. 108 -116. Holos editora. Ribeir\u00e3o Preto, SP. 2001. Sakamoto, T., Ortega, J.M. TaxOnTree: a tool that generates trees annotated with taxonomic information. bioRxiv 2020. DOI: 10.1101/2020.12.24.424364 . Sttebins, G. L. Processos de Evolu\u00e7\u00e3o Org\u00e2nica. Editora Pol\u00edgono e Editora da Universidade de S\u00e3o Paulo. S\u00e3o Paulo. 1970. 253p. Van de Peer, Y. Phylogenetic inference based on distance methods. In - Lemey, P., Salemi, M., Vandamme, A. (eds.). The Phylogenetic Handbook: a Practical Approach to Phylogenetic Analysis and Hypothesis Testing, Published by Cambridge University Press. Cambridge University Press 2009. Xia X. DAMBE6: New Tools for Microbial Genomics, Phylogenetics, and Molecular Evolution. Journal of Heredity. 2017;108(4):431-437. doi:10.1093/jhered/esx033. Xia, X. 2000. Data Analysis in Molecular Biology and Evolution. Kluwer Academic Publishers. Xia, X. Assessing substitution saturation with Dambe. In Lemey, P., Salemi, M., Vandamme, A. (eds.). The Phylogenetic Handbook: a Practical Approach to Phylogenetic Analysis and Hypothesis Testing, Published by Cambridge University Press. Cambridge University Press 2009. Yang Z, Rannala B. Molecular phylogenetics: principles and practice. Nature Review Genetics. 2012;13(303):1-12. doi:10.1038/nrg3186.","title":"References"},{"location":"ModelTest_ENG/","text":"Choosing an appropriate substitution Model Introduction The objective of this tutorial is to show the different ways to evaluate and estimate a nucleotide (and amino acid) replacement model suitable for your dataset for later phylogenetic analysis. As highlighted during the course, the step of estimating a replacement model is not necessarily mandatory in any phylogenetic analysis. When the working sequences and the characteristics of the obtained alignment are well known, the researcher can directly choose a single mathematical model. However, as there are numerous models available, such a choice can be challenging for beginners. In the worst case, ignorance can lead to the choice of a model that underestimates important alignment characteristics, leading to less accurate estimates. On the other hand, including many parameters increases the variance and consequently the accuracy of the analyses (and, sometimes, can also increase computational power requirements). Most tools use the statistical principle of likelihood ( L ). To do this, they calculate L for all available models and then make a hierarchical classification (using or not information criteria). Depending on the size of your dataset, these calculations can be computationally intensive even for many current PCs. Using MEGA X In its first version, the program MEGA did not have a routine for testing the substitution model. Even so, it was one of the first phylogenetic programs to include this functionality natively. The algorithm is fast. However, it tests more models than are available in the tool itself. We will use the multiple alignment file vert-aligned.fasta : Run the MEGAX program. Open the alignment by clicking on the TA button and then on Open a File/Session... , according to the picture below: In the next pop-up window, click on Analyze (these sequences are already aligned): MEGA will ask you the following questions: whether they are nucleotide sequences. Click Ok. They are protein-coding sequences. Answer Yes . When answering, you will need to select the specific genetic code. Click Vertebrate Mitochondrial : With the file open, click on Models , And select the first item, Find Best DNA/Protein Models (ML)... : Answer yes in the dialog box that appears right after, to use the open dataset: After confirmation, the following box will appear: Let us look at the options (as shown in the figure above): We will use an automatic Neighbor-Joining tree as the initial hypothesis for this data. Since the sequences of this alignment are nucleotides, we will use the appropriate type of substitutions. In the data subgroups options, we will use all sites, all codon positions, and we will not use filters for branch exchange ( Branch-swap filter ). Leave the number of Threads in the pattern that appeared on the computer you are using. Finally, click Ok. The process will take a while, depending on the available computing resources. The results will appear as the table below: The results appear in a list of the best model to the least suitable for the data used. In MEGA X the information criterion used is Bayesian (BIC). By it, we can verify that the GTR model ( General Time-reversible ) plus gamma correction (+G) was the model chosen by the Bayesian criterion. However, it is not the model with the least likelihood ( lnL ). The rest of the information in this table will be discussed during the remote meeting. Do not forget to save this table in one of the formats that MEGA X provides, from the icons present in the upper left corner of the screen. MEGA X also has the function to calculate the best amino acid substitution model. To do this, just start the analyses with an amino acid alignment and in the dialog box choose the correct option. * Using jModelTest The jModelTest program ( Darriba et al. 2012 ) is an extended version of the popular ModelTest program (which was a routine run within the PAUP* program.) The program is now standalone and much faster after the inclusion of the PHYML , ReadSeq and Consense tools from the old PHYLIP package. Additionally, jModelTest allows the optimization of base trees for each model, model selection according to a new theoretical decision criterion, and average model phylogenies. Recently, a new improved and faster version, which serves both DNA and protein sequences, ModelTest-NG ( Darriba et al. 2019 ) has been released. Observation: Some information on the steps below has been adapted from that described in http://evomics.org/learning/phylogenetics/jmodeltest/ , for teaching purposes only . Reproduction for any other purpose is not allowed or consented to by the course professor. Steps Download version 2.1.10 of jModelTest. The program is a java application and executes in distinct two ways: command line and GUI ( Graphical User Interface ). The program depends on the installation of a JDK ( Java Development Kit ), be it the official Oracle or OpenJDK . The JDK installation steps depend on the operating system and therefore, will not be detailed here in this tutorial. Do not confuse JDK with JRE (Java Runtime Environment), which is usually present on most computers. We will use the same file used previously: vert-aligned.fasta . Go to the directory where you saved the jModelTest application and double click jModelTest.jar to open it. Using Linux, you may have to open a terminal, browse to the folder where this file is located and type the command below to open the program: $ java -jar jModelTest The window below will appear: Click File > Load DNA alignment and open the data set vert-aligned.fasta file. Click Analysis > Compute likelihood scores to start the analysis. A dialog box will appear that allows you to specify the number of probability settings, including the number of models to be tested. The other settings are different base frequencies (+F); the proportion of invariable sites (+I), and gamma distribution (+G) (variation in rate across sites). In this dialog box, leave the options as in the figure below. Click on Compute Likelihoods and wait (or go for a coffee, because depending on the dataset this step will take longer than the one performed on MEGA X). For the alignment used here and with these options, this step will take between 1 and 4 min. Sometimes, depending on the operating system, you will have to locate the PhyML program executable again. In the main window, just go to Edit > Preferences and find the correct executable again for the computer operating system. Before proceeding, check the data that appeared in the jModelTest console. They will also be discussed in the room, but are similar to those found in testing the model using MEGA X. Now click again on the Analysis menu. You will see that the AIC, BIC, and DT calculations are now available, while the hLRT calculations are grayed out (because in the previous step, we chose to have optimized tree topologies). Now click on Results > Show results table . A window will appear, showing the calculated probabilities for each model. Now click on the top of the \"LnL\" column. This action will sort the models according to likelihood. The table will then look like this: It can show the partition schemes, the number of parameters included the observed base frequencies, and the transition and transversion rates. Note that the tables for AIC, AICc, BIC, and DT results are in grey. For that, the table can be closed, and from the Analysis menu click on Do BIC calculations... and on Do DT calculations... , confirming each dialog box that will appear later, as can be verified in the figure below: Make sure that the options Calculate parameter imports and Do model averaging are always selected Then, we will go to Analysis > Do AIC calculations... . In the backbox, check the option Use AICc correction , as shown in the figure below: You can also do the Akaike calculation without the correction for comparison purposes. Just do not select the above option Now click again on Results > Show results table . A window will appear showing the calculated probabilities for each model, with the information criteria. The chosen models for each criterion will be marked in red. To avoid repeating the analyses (which wastes computational time), screeshot the table with the final results and save the whole console content from the menu Edit > Save console. From the results obtained, you will observe that the results converge, although with some discrepancies. The GTR+G+I model is the best for Akaike's criterion, but not the best for Bayesian criterion. Which one to choose, then? Let us discuss. Using ProtTest The program ProtTest ( Darriba et al. 2011 ) is a very similar program to jModelTest, however specific for the choice of the best substitution models for protein sequence alignments. Prottest 3 can be obtained HERE and run in the same way as jModelTest (it is also a Java application). MEGA X also has the function to calculate the best amino acid substitution model. To do this, just start the analyses with an amino acid alignment and in the dialog box choose the correct option. To demonstrate ProtTest's operation, we will use the amino acid alignment COX2_PF0016 , one of the examples provided with the program itself. Click on File > Load alignment and open the downloaded COX2_PF0016 file above. See the information that appeared in the application console. Then go to Analysis > Compute likelihood scores to start the analysis. A dialog will appear that allows you to specify the number and models to be tested in addition to some other settings. In Starting Topology choose Maximum likelihood tree or leave the default ( Fixed BioNJ JTT ). Click Compute and wait for the calculations to finish. Now you should have a coffee time. The likelihood calculation for amino acid replacement models is considerably more intensive, mainly due to the more significant possible number of changes and the number of characters involved (20 amino acids). When finished, just click the Selection menu and click Results . The results table will appear. A notable difference between ProtTest and jModelTest is that the calculations of the information criteria are within the results table. Analyze the table. More information will be given in the classroom. Comparing resultados Compare the results obtained for the COX2_PF0016 alignment in both ProtTest and MEGA X. To use this alignment on MEGA, use this file . Below is a table with the results. ModelTest-NG ModelTest-NG is a new improved and faster version of jModelTest, which serves both DNA and protein sequences ( Darriba et al. 2019 ). Its performance for larger datasets is much better, and its calculations are more optimized. However, its installation on Windows and macOS systems is not yet accessible, especially for beginners. On Linux, the installation is relatively fast. For this reason, we will see just a quick demonstration. For this we will use the same file used previously: vert-aligned.fasta . Run ModelTest-NG: Click on Load MSA and choose the file above. The alignment characteristics will appear. Click the \"Settings\" tab, and you will see the test options, similar to previous programs. Do not forget to change the initial tree to one of Maximum likelihood . Once you have done that, you can click on Run . Notice how ModelTest-NG is faster than its previous versions. The results are almost the same as in jModelTest. We will now click on Reset and repeat the previous steps for the alignment COX2_PF0016 . Since this alignment is of amino acid sequences, do not forget to mark in the Settings tab the option Protein , because in our tests ModelTest-NG does not always correctly identify the type of sequence. Below is a preview of the result: Final remarks Where do I find more information about the substitution models? The Github from the ModelTest project has a page describing all the models used in the program with their respectives references. It is interesting to know the authors' motivation/application for the created substitution model. Here is the page: https://github.com/ddarriba/modeltest/wiki/Models-of-Evolution . What criteria do I use to choose the replacement model? That is not a trivial question. For Bayesian inferences, the BIC criterion tends to be more appropriate. AICc is more suitable for small datasets than AIC (no correction), however, the two tend to converge on more massive datasets , so we always recommend using AICc. The DT criterion ( decision theory ) should be used with caution, as the jModelTest manual itself recommends. Thus, AICc and BIC are the most reliable criteria. When they converge (and this often happens), the problem is solved. Even without convergence, you will be safe if you do phylogenetic analysis with both the model chosen by AICc and the one chosen by BIC. The chosen model does not exist in the tool I will use It is not the end of the world. There are many models, but there are also many overlaps between them. Hence the importance of knowing the characteristics of alignment and the differences in parameters between the different models. Often the models selected by these tools have small differences. Just look for the equivalent model or the one closest in terms of parameters. The execution of jModelTest presents another significant advantage: the console gives a summary of the parameters evaluated in each of the models tested for you to make a more appropriate choice. Even so, nothing will replace understanding the models and their parameters. That is why some phylogeneticists do not consider testing the model an indispensable step. Average phylogeny of all models Average phylogeny of all models is a function that only ModelTest and its variants have. This function calculates the models' average phylogenies, which are consensus trees of all optimized basal trees. However, it currently depends on the PHYLIP package for this function. It may not work if the taxon names are longer than 10 characters (anyone who has used PHYLIP ever knows how unbearable this limitation is). To get this, from the Analysis menu, click on Model-averaged Phylogeny . A window with the settings will open, in which you will leave all the settings in the default and click on Run . The output will list some configurations, the models, and the average phylogeny of these models. This is a great guide, however, it should be used with great caution.","title":"Test of the Best-Fit Models"},{"location":"ModelTest_ENG/#choosing-an-appropriate-substitution-model","text":"","title":"Choosing an appropriate substitution Model"},{"location":"ModelTest_ENG/#introduction","text":"The objective of this tutorial is to show the different ways to evaluate and estimate a nucleotide (and amino acid) replacement model suitable for your dataset for later phylogenetic analysis. As highlighted during the course, the step of estimating a replacement model is not necessarily mandatory in any phylogenetic analysis. When the working sequences and the characteristics of the obtained alignment are well known, the researcher can directly choose a single mathematical model. However, as there are numerous models available, such a choice can be challenging for beginners. In the worst case, ignorance can lead to the choice of a model that underestimates important alignment characteristics, leading to less accurate estimates. On the other hand, including many parameters increases the variance and consequently the accuracy of the analyses (and, sometimes, can also increase computational power requirements). Most tools use the statistical principle of likelihood ( L ). To do this, they calculate L for all available models and then make a hierarchical classification (using or not information criteria). Depending on the size of your dataset, these calculations can be computationally intensive even for many current PCs.","title":"Introduction"},{"location":"ModelTest_ENG/#using-mega-x","text":"In its first version, the program MEGA did not have a routine for testing the substitution model. Even so, it was one of the first phylogenetic programs to include this functionality natively. The algorithm is fast. However, it tests more models than are available in the tool itself. We will use the multiple alignment file vert-aligned.fasta : Run the MEGAX program. Open the alignment by clicking on the TA button and then on Open a File/Session... , according to the picture below: In the next pop-up window, click on Analyze (these sequences are already aligned): MEGA will ask you the following questions: whether they are nucleotide sequences. Click Ok. They are protein-coding sequences. Answer Yes . When answering, you will need to select the specific genetic code. Click Vertebrate Mitochondrial : With the file open, click on Models , And select the first item, Find Best DNA/Protein Models (ML)... : Answer yes in the dialog box that appears right after, to use the open dataset: After confirmation, the following box will appear: Let us look at the options (as shown in the figure above): We will use an automatic Neighbor-Joining tree as the initial hypothesis for this data. Since the sequences of this alignment are nucleotides, we will use the appropriate type of substitutions. In the data subgroups options, we will use all sites, all codon positions, and we will not use filters for branch exchange ( Branch-swap filter ). Leave the number of Threads in the pattern that appeared on the computer you are using. Finally, click Ok. The process will take a while, depending on the available computing resources. The results will appear as the table below: The results appear in a list of the best model to the least suitable for the data used. In MEGA X the information criterion used is Bayesian (BIC). By it, we can verify that the GTR model ( General Time-reversible ) plus gamma correction (+G) was the model chosen by the Bayesian criterion. However, it is not the model with the least likelihood ( lnL ). The rest of the information in this table will be discussed during the remote meeting. Do not forget to save this table in one of the formats that MEGA X provides, from the icons present in the upper left corner of the screen. MEGA X also has the function to calculate the best amino acid substitution model. To do this, just start the analyses with an amino acid alignment and in the dialog box choose the correct option. *","title":"Using MEGA X"},{"location":"ModelTest_ENG/#using-jmodeltest","text":"The jModelTest program ( Darriba et al. 2012 ) is an extended version of the popular ModelTest program (which was a routine run within the PAUP* program.) The program is now standalone and much faster after the inclusion of the PHYML , ReadSeq and Consense tools from the old PHYLIP package. Additionally, jModelTest allows the optimization of base trees for each model, model selection according to a new theoretical decision criterion, and average model phylogenies. Recently, a new improved and faster version, which serves both DNA and protein sequences, ModelTest-NG ( Darriba et al. 2019 ) has been released. Observation: Some information on the steps below has been adapted from that described in http://evomics.org/learning/phylogenetics/jmodeltest/ , for teaching purposes only . Reproduction for any other purpose is not allowed or consented to by the course professor.","title":"Using jModelTest"},{"location":"ModelTest_ENG/#steps","text":"Download version 2.1.10 of jModelTest. The program is a java application and executes in distinct two ways: command line and GUI ( Graphical User Interface ). The program depends on the installation of a JDK ( Java Development Kit ), be it the official Oracle or OpenJDK . The JDK installation steps depend on the operating system and therefore, will not be detailed here in this tutorial. Do not confuse JDK with JRE (Java Runtime Environment), which is usually present on most computers. We will use the same file used previously: vert-aligned.fasta . Go to the directory where you saved the jModelTest application and double click jModelTest.jar to open it. Using Linux, you may have to open a terminal, browse to the folder where this file is located and type the command below to open the program: $ java -jar jModelTest The window below will appear: Click File > Load DNA alignment and open the data set vert-aligned.fasta file. Click Analysis > Compute likelihood scores to start the analysis. A dialog box will appear that allows you to specify the number of probability settings, including the number of models to be tested. The other settings are different base frequencies (+F); the proportion of invariable sites (+I), and gamma distribution (+G) (variation in rate across sites). In this dialog box, leave the options as in the figure below. Click on Compute Likelihoods and wait (or go for a coffee, because depending on the dataset this step will take longer than the one performed on MEGA X). For the alignment used here and with these options, this step will take between 1 and 4 min. Sometimes, depending on the operating system, you will have to locate the PhyML program executable again. In the main window, just go to Edit > Preferences and find the correct executable again for the computer operating system. Before proceeding, check the data that appeared in the jModelTest console. They will also be discussed in the room, but are similar to those found in testing the model using MEGA X. Now click again on the Analysis menu. You will see that the AIC, BIC, and DT calculations are now available, while the hLRT calculations are grayed out (because in the previous step, we chose to have optimized tree topologies). Now click on Results > Show results table . A window will appear, showing the calculated probabilities for each model. Now click on the top of the \"LnL\" column. This action will sort the models according to likelihood. The table will then look like this: It can show the partition schemes, the number of parameters included the observed base frequencies, and the transition and transversion rates. Note that the tables for AIC, AICc, BIC, and DT results are in grey. For that, the table can be closed, and from the Analysis menu click on Do BIC calculations... and on Do DT calculations... , confirming each dialog box that will appear later, as can be verified in the figure below: Make sure that the options Calculate parameter imports and Do model averaging are always selected Then, we will go to Analysis > Do AIC calculations... . In the backbox, check the option Use AICc correction , as shown in the figure below: You can also do the Akaike calculation without the correction for comparison purposes. Just do not select the above option Now click again on Results > Show results table . A window will appear showing the calculated probabilities for each model, with the information criteria. The chosen models for each criterion will be marked in red. To avoid repeating the analyses (which wastes computational time), screeshot the table with the final results and save the whole console content from the menu Edit > Save console. From the results obtained, you will observe that the results converge, although with some discrepancies. The GTR+G+I model is the best for Akaike's criterion, but not the best for Bayesian criterion. Which one to choose, then? Let us discuss.","title":"Steps"},{"location":"ModelTest_ENG/#using-prottest","text":"The program ProtTest ( Darriba et al. 2011 ) is a very similar program to jModelTest, however specific for the choice of the best substitution models for protein sequence alignments. Prottest 3 can be obtained HERE and run in the same way as jModelTest (it is also a Java application). MEGA X also has the function to calculate the best amino acid substitution model. To do this, just start the analyses with an amino acid alignment and in the dialog box choose the correct option. To demonstrate ProtTest's operation, we will use the amino acid alignment COX2_PF0016 , one of the examples provided with the program itself. Click on File > Load alignment and open the downloaded COX2_PF0016 file above. See the information that appeared in the application console. Then go to Analysis > Compute likelihood scores to start the analysis. A dialog will appear that allows you to specify the number and models to be tested in addition to some other settings. In Starting Topology choose Maximum likelihood tree or leave the default ( Fixed BioNJ JTT ). Click Compute and wait for the calculations to finish. Now you should have a coffee time. The likelihood calculation for amino acid replacement models is considerably more intensive, mainly due to the more significant possible number of changes and the number of characters involved (20 amino acids). When finished, just click the Selection menu and click Results . The results table will appear. A notable difference between ProtTest and jModelTest is that the calculations of the information criteria are within the results table. Analyze the table. More information will be given in the classroom.","title":"Using ProtTest"},{"location":"ModelTest_ENG/#comparing-resultados","text":"Compare the results obtained for the COX2_PF0016 alignment in both ProtTest and MEGA X. To use this alignment on MEGA, use this file . Below is a table with the results.","title":"Comparing resultados"},{"location":"ModelTest_ENG/#modeltest-ng","text":"ModelTest-NG is a new improved and faster version of jModelTest, which serves both DNA and protein sequences ( Darriba et al. 2019 ). Its performance for larger datasets is much better, and its calculations are more optimized. However, its installation on Windows and macOS systems is not yet accessible, especially for beginners. On Linux, the installation is relatively fast. For this reason, we will see just a quick demonstration. For this we will use the same file used previously: vert-aligned.fasta . Run ModelTest-NG: Click on Load MSA and choose the file above. The alignment characteristics will appear. Click the \"Settings\" tab, and you will see the test options, similar to previous programs. Do not forget to change the initial tree to one of Maximum likelihood . Once you have done that, you can click on Run . Notice how ModelTest-NG is faster than its previous versions. The results are almost the same as in jModelTest. We will now click on Reset and repeat the previous steps for the alignment COX2_PF0016 . Since this alignment is of amino acid sequences, do not forget to mark in the Settings tab the option Protein , because in our tests ModelTest-NG does not always correctly identify the type of sequence. Below is a preview of the result:","title":"ModelTest-NG"},{"location":"ModelTest_ENG/#final-remarks","text":"Where do I find more information about the substitution models? The Github from the ModelTest project has a page describing all the models used in the program with their respectives references. It is interesting to know the authors' motivation/application for the created substitution model. Here is the page: https://github.com/ddarriba/modeltest/wiki/Models-of-Evolution . What criteria do I use to choose the replacement model? That is not a trivial question. For Bayesian inferences, the BIC criterion tends to be more appropriate. AICc is more suitable for small datasets than AIC (no correction), however, the two tend to converge on more massive datasets , so we always recommend using AICc. The DT criterion ( decision theory ) should be used with caution, as the jModelTest manual itself recommends. Thus, AICc and BIC are the most reliable criteria. When they converge (and this often happens), the problem is solved. Even without convergence, you will be safe if you do phylogenetic analysis with both the model chosen by AICc and the one chosen by BIC. The chosen model does not exist in the tool I will use It is not the end of the world. There are many models, but there are also many overlaps between them. Hence the importance of knowing the characteristics of alignment and the differences in parameters between the different models. Often the models selected by these tools have small differences. Just look for the equivalent model or the one closest in terms of parameters. The execution of jModelTest presents another significant advantage: the console gives a summary of the parameters evaluated in each of the models tested for you to make a more appropriate choice. Even so, nothing will replace understanding the models and their parameters. That is why some phylogeneticists do not consider testing the model an indispensable step. Average phylogeny of all models Average phylogeny of all models is a function that only ModelTest and its variants have. This function calculates the models' average phylogenies, which are consensus trees of all optimized basal trees. However, it currently depends on the PHYLIP package for this function. It may not work if the taxon names are longer than 10 characters (anyone who has used PHYLIP ever knows how unbearable this limitation is). To get this, from the Analysis menu, click on Model-averaged Phylogeny . A window with the settings will open, in which you will leave all the settings in the default and click on Run . The output will list some configurations, the models, and the average phylogeny of these models. This is a great guide, however, it should be used with great caution.","title":"Final remarks"},{"location":"Substitution_saturation_ENG/","text":"Analysis of Substitution Saturation The substitution saturation estimation is an essential analysis to check if the alignment sequences still maintain a phylogenetic signal. Saturation is much more common in nucleotide sequences. There are two methods: one extremely simple and qualitative and the other quantitative, with associated probability (the Xia method, 2009). Both are implemented in the program DAMBE ( Xia, 2018 ). DAMBE ( Xia, 2018 ) is a suite with several phylogenetic and sequence analysis applications. Additionally, it is multi-platform (except if you run MacOS Catalina, as it is not completely 64 bits - Feb 2020) and simple to use. To our knowledge, it is the only phylogenetic analysis program that performs these tests. The Qualitative Method The qualitative method of substitution saturation analysis consists of analyzing a plot called \"transition and transversals versus divergence\" ( transitions and transversals versus divergence ). This method assumes that the distance calculated between the sequences is directly proportional to the divergence time between them, either on any scale. The steps to obtain this graph are: Open the DAMBE program. Click on File and then on Open Standard Sequence File . Select the dataset VertCOI.fas . Click Open . In the dialog box that appears, called SequenceInfo , check the option Protein-coding Nuc-Seq . In this same window, in the Genetic Code options, choose the number 2 (from the Vertebrate mitochondria). In the main window, the alignment will appear in Clustal format. On DAMBE's main menu, go to Graphics and click on *transition and transversion versus divergence . A new dialog box will appear. In it, the default values can be used. However, we will change the genetic distance ( Genetic distance field) to TN93, as shown in the figure below: Click on Go and watch the resulting graph. To make the visualization easier, leave the options as below: The letter \"s\" refers to the transitions and the letter \"v\" to the transversions*. Compare the graph above with the figure below and draw your conclusions about the saturation of these sequences. The quantitative method The Xia method is a quantitative method, based on entropy, that assigns a significant value to the saturation of substitutions. It returns two criteria: Iss and Iss.c. The first is the substitution saturation index. The second is the critical substitution saturation index, which is the value of Iss at which sequences can no longer return the correct tree. When an observed Iss value is significantly lower than Iss.c (Iss < Iss.c), substitution saturation is not a problem for the dataset in question. The steps to perform this method are: Open the DAMBE program. Click on File and then on Open Standard Sequence File . Select VertCOI.fas dataset. Click on Open . In the dialog box that appears, called SequenceInfo , check the option Protein-coding Nuc-Seq . In this same window, in the Genetic Code options, choose the number 2 (from the Vertebrate mitochondria). In the main window, the alignment will appear in Clustal format. Before continuing, the proportion of invariable sites (Pinvar) should be calculated for this dataset . This parameter is crucial for sequences with very different substitution rates along with the sites. To do this, follow the path: Seq.Analysis > Substitution rates over site > Estimate proportion of invariant sites . In the dialog box that follows, check the \" Use a new tree \" option. In the new window, choose the Neighbor-Joining method, choose the appropriate outgroup (for this example, we will use Alligator mississippis ) and keep the rest of the options the way it is. Click on Run and then click on Go . At the end of the text output, Pinvar will be described, as below: Estimation based on tree: (AlligatorMississippiensis:0.13730,(MasturusLanceolatus:0.15730,(((HomoSapiens:0.04522,PanTroglodytes:0.04795):0.02113,PongoPygmaeus:0.08982):0.05970,(BosTaurus:0.09378,BalaenopteraMusculus:0.10744):0.01982):0.01484):0.01673,GallusGallus:0.12297); Estimating the proportion of invariant sites by iteration. (Poisson+I) Iter Phi Pinv ------------------------------------- 0 0.85377 0.28746 1 0.85377 0.25871 2 0.85377 0.31960 3 0.73189 0.42154 4 0.62860 0.47955 5 0.57154 0.51389 6 0.56361 0.52394 7 0.56361 0.53330 8 0.56361 0.52737 9 0.56361 0.52462 10 0.56361 0.52224 11 0.56361 0.52258 12 0.56361 0.52122 13 0.56361 0.52089 14 0.56361 0.51988 15 0.56361 0.51954 16 0.56361 0.51887 17 0.56361 0.51821 18 0.56361 0.51754 19 0.56361 0.51688 20 0.56361 0.51621 21 0.56361 0.51555 ------------------------------------- P(invariant) = 0.51555 Save or write down the Pinvar value (0.51555). Depending on your operating system's language settings, you will have to use decimal notation as a period and not as a comma. Pay close attention to this.* Now let us estimate the saturation of substitutions (the program may present some problems, and so, in some cases, the sequence file should be opened again). Click on \" Seq.Analysis > Measure substitution saturation > Test by Xia et al. \". In the window, just put the Pinvar value calculated and then click Go. Analyze the results (further comments will be made during the practice). Test of substitution saturation (Xia et al. 2003; Xia and Lemey 2009) Testing whether the observed Iss is significantly lower than Iss.c. Part I. For a symmetrical tree. ======================================================== Prop. invar. sites 0.5156 Mean H 0.9205 Standard Error 0.0183 Hmax 1.6517 Iss 0.5573 Iss.c 0.8093 T 13.7506 DF 731 Prob (Two-tailed) 0.0000 95% Lower Limit 0.5214 95% Upper Limit 0.5933 ======================================================== Part II. For an extreme asymmetrical (and generally very unlikely) tree. ======================================================== Iss.c 0.7095 T 8.3050 DF 731 Prob (Two-tailed) 0.0000 95% Lower Limit 0.5214 95% Upper Limit 0.5933 ======================================================== Interpretation of results: Significant Difference ---------------------- Yes No ------------------------------------------------------- Iss < Iss.c Little Substantial saturation saturation ------------------------------------------------------- Iss > Iss.c Useless Very poor sequences for phylogenetics ------------------------------------------------------- Please cite: Xia, X., Z. Xie, M. Salemi, L. Chen, Y. Wang. 2003. An index of substitution saturation and its application. Molecular Phylogenetics and Evolution 26:1-7. Xia, X. and Lemey, P. 2009. Assessing substitution saturation with DAMBE. Pp. 615-630 in Philippe Lemey, Marco Salemi and Anne-Mieke Vandamme, eds. The Phylogenetic Handbook: A Practical Approach to DNA and Protein Phylogeny. 2nd edition Cambridge University Press. It can be verified that both scenarios have Iss<Iss.c. Therefore these sequences do not present substitution saturation and can be used for phylogenetic analysis. Influence of the position on the codon Due to the genetic code characteristics, nucleotide sequences coding for proteins tends to show a higher number of changes in the 3rd position of the codon than in the 1st and 2nd position. Therefore, in these cases, the ideal is to perform both methods for all codon positions (this option will be shown during practice). The table below shows all Pinvar, Iss, and Iss.c data for all codon positions. Positions Pinvar Iss Iss.c P All 0.51555 0.5573 0.8093 0.0000 1st position 0.64014 0.3814 0.7519 0.0000 2nd position 0.42518 0.0655 0.7519 0.0000 3rd position 0.02485 0.7340 0.7519 0.3540 1st e 2nd positions 0.37664 0.1391 0.7886 0.0000 Final Remarks You should always perform the analysis of substitution saturation whenever working with a new or not widely known marker. If you are using genes or proteins already known and commonly used in the literature studies, these estimates, although still recommended, are not indispensable. However, you can still perform these tests to confirm if the marker is suitable to the taxonomic level/rank that you are working on. Sometimes qualitative analysis is sufficient, but you can (and should) use the quantitative method if the graph presents a problematic interpretation.sudo apt install ttf-mscorefonts-installer -y","title":"Analysis of Substitution Saturation"},{"location":"Substitution_saturation_ENG/#analysis-of-substitution-saturation","text":"The substitution saturation estimation is an essential analysis to check if the alignment sequences still maintain a phylogenetic signal. Saturation is much more common in nucleotide sequences. There are two methods: one extremely simple and qualitative and the other quantitative, with associated probability (the Xia method, 2009). Both are implemented in the program DAMBE ( Xia, 2018 ). DAMBE ( Xia, 2018 ) is a suite with several phylogenetic and sequence analysis applications. Additionally, it is multi-platform (except if you run MacOS Catalina, as it is not completely 64 bits - Feb 2020) and simple to use. To our knowledge, it is the only phylogenetic analysis program that performs these tests.","title":"Analysis of Substitution Saturation"},{"location":"Substitution_saturation_ENG/#the-qualitative-method","text":"The qualitative method of substitution saturation analysis consists of analyzing a plot called \"transition and transversals versus divergence\" ( transitions and transversals versus divergence ). This method assumes that the distance calculated between the sequences is directly proportional to the divergence time between them, either on any scale. The steps to obtain this graph are: Open the DAMBE program. Click on File and then on Open Standard Sequence File . Select the dataset VertCOI.fas . Click Open . In the dialog box that appears, called SequenceInfo , check the option Protein-coding Nuc-Seq . In this same window, in the Genetic Code options, choose the number 2 (from the Vertebrate mitochondria). In the main window, the alignment will appear in Clustal format. On DAMBE's main menu, go to Graphics and click on *transition and transversion versus divergence . A new dialog box will appear. In it, the default values can be used. However, we will change the genetic distance ( Genetic distance field) to TN93, as shown in the figure below: Click on Go and watch the resulting graph. To make the visualization easier, leave the options as below: The letter \"s\" refers to the transitions and the letter \"v\" to the transversions*. Compare the graph above with the figure below and draw your conclusions about the saturation of these sequences.","title":"The Qualitative Method"},{"location":"Substitution_saturation_ENG/#the-quantitative-method","text":"The Xia method is a quantitative method, based on entropy, that assigns a significant value to the saturation of substitutions. It returns two criteria: Iss and Iss.c. The first is the substitution saturation index. The second is the critical substitution saturation index, which is the value of Iss at which sequences can no longer return the correct tree. When an observed Iss value is significantly lower than Iss.c (Iss < Iss.c), substitution saturation is not a problem for the dataset in question. The steps to perform this method are: Open the DAMBE program. Click on File and then on Open Standard Sequence File . Select VertCOI.fas dataset. Click on Open . In the dialog box that appears, called SequenceInfo , check the option Protein-coding Nuc-Seq . In this same window, in the Genetic Code options, choose the number 2 (from the Vertebrate mitochondria). In the main window, the alignment will appear in Clustal format. Before continuing, the proportion of invariable sites (Pinvar) should be calculated for this dataset . This parameter is crucial for sequences with very different substitution rates along with the sites. To do this, follow the path: Seq.Analysis > Substitution rates over site > Estimate proportion of invariant sites . In the dialog box that follows, check the \" Use a new tree \" option. In the new window, choose the Neighbor-Joining method, choose the appropriate outgroup (for this example, we will use Alligator mississippis ) and keep the rest of the options the way it is. Click on Run and then click on Go . At the end of the text output, Pinvar will be described, as below: Estimation based on tree: (AlligatorMississippiensis:0.13730,(MasturusLanceolatus:0.15730,(((HomoSapiens:0.04522,PanTroglodytes:0.04795):0.02113,PongoPygmaeus:0.08982):0.05970,(BosTaurus:0.09378,BalaenopteraMusculus:0.10744):0.01982):0.01484):0.01673,GallusGallus:0.12297); Estimating the proportion of invariant sites by iteration. (Poisson+I) Iter Phi Pinv ------------------------------------- 0 0.85377 0.28746 1 0.85377 0.25871 2 0.85377 0.31960 3 0.73189 0.42154 4 0.62860 0.47955 5 0.57154 0.51389 6 0.56361 0.52394 7 0.56361 0.53330 8 0.56361 0.52737 9 0.56361 0.52462 10 0.56361 0.52224 11 0.56361 0.52258 12 0.56361 0.52122 13 0.56361 0.52089 14 0.56361 0.51988 15 0.56361 0.51954 16 0.56361 0.51887 17 0.56361 0.51821 18 0.56361 0.51754 19 0.56361 0.51688 20 0.56361 0.51621 21 0.56361 0.51555 ------------------------------------- P(invariant) = 0.51555 Save or write down the Pinvar value (0.51555). Depending on your operating system's language settings, you will have to use decimal notation as a period and not as a comma. Pay close attention to this.* Now let us estimate the saturation of substitutions (the program may present some problems, and so, in some cases, the sequence file should be opened again). Click on \" Seq.Analysis > Measure substitution saturation > Test by Xia et al. \". In the window, just put the Pinvar value calculated and then click Go. Analyze the results (further comments will be made during the practice). Test of substitution saturation (Xia et al. 2003; Xia and Lemey 2009) Testing whether the observed Iss is significantly lower than Iss.c. Part I. For a symmetrical tree. ======================================================== Prop. invar. sites 0.5156 Mean H 0.9205 Standard Error 0.0183 Hmax 1.6517 Iss 0.5573 Iss.c 0.8093 T 13.7506 DF 731 Prob (Two-tailed) 0.0000 95% Lower Limit 0.5214 95% Upper Limit 0.5933 ======================================================== Part II. For an extreme asymmetrical (and generally very unlikely) tree. ======================================================== Iss.c 0.7095 T 8.3050 DF 731 Prob (Two-tailed) 0.0000 95% Lower Limit 0.5214 95% Upper Limit 0.5933 ======================================================== Interpretation of results: Significant Difference ---------------------- Yes No ------------------------------------------------------- Iss < Iss.c Little Substantial saturation saturation ------------------------------------------------------- Iss > Iss.c Useless Very poor sequences for phylogenetics ------------------------------------------------------- Please cite: Xia, X., Z. Xie, M. Salemi, L. Chen, Y. Wang. 2003. An index of substitution saturation and its application. Molecular Phylogenetics and Evolution 26:1-7. Xia, X. and Lemey, P. 2009. Assessing substitution saturation with DAMBE. Pp. 615-630 in Philippe Lemey, Marco Salemi and Anne-Mieke Vandamme, eds. The Phylogenetic Handbook: A Practical Approach to DNA and Protein Phylogeny. 2nd edition Cambridge University Press. It can be verified that both scenarios have Iss<Iss.c. Therefore these sequences do not present substitution saturation and can be used for phylogenetic analysis.","title":"The quantitative method"},{"location":"Substitution_saturation_ENG/#influence-of-the-position-on-the-codon","text":"Due to the genetic code characteristics, nucleotide sequences coding for proteins tends to show a higher number of changes in the 3rd position of the codon than in the 1st and 2nd position. Therefore, in these cases, the ideal is to perform both methods for all codon positions (this option will be shown during practice). The table below shows all Pinvar, Iss, and Iss.c data for all codon positions. Positions Pinvar Iss Iss.c P All 0.51555 0.5573 0.8093 0.0000 1st position 0.64014 0.3814 0.7519 0.0000 2nd position 0.42518 0.0655 0.7519 0.0000 3rd position 0.02485 0.7340 0.7519 0.3540 1st e 2nd positions 0.37664 0.1391 0.7886 0.0000","title":"Influence of the position on the codon"},{"location":"Substitution_saturation_ENG/#final-remarks","text":"You should always perform the analysis of substitution saturation whenever working with a new or not widely known marker. If you are using genes or proteins already known and commonly used in the literature studies, these estimates, although still recommended, are not indispensable. However, you can still perform these tests to confirm if the marker is suitable to the taxonomic level/rank that you are working on. Sometimes qualitative analysis is sufficient, but you can (and should) use the quantitative method if the graph presents a problematic interpretation.sudo apt install ttf-mscorefonts-installer -y","title":"Final Remarks"},{"location":"UC_slides/","text":"Slides used Direct links Part 1 Part 2 Part 3 PDF Files Part 1 Part 2 Part 3","title":"Slides"},{"location":"UC_slides/#slides-used","text":"","title":"Slides used"},{"location":"UC_slides/#direct-links","text":"Part 1 Part 2 Part 3","title":"Direct links"},{"location":"UC_slides/#pdf-files","text":"Part 1 Part 2 Part 3","title":"PDF Files"},{"location":"aboutus/","text":"About Us: EvoMol-Lab The Laboratory of Evolution of Molecules and Systems (EvoMol-Lab) is one of the research groups associated with the Bioinformatics Multidisciplinary Environment (BioME) , from the Digital Metropolis Institute (IMD) of the Federal University of Rio Grande do Norte ( UFRN ). EvoMol-Lab's mission is to study evolutionary processes that act on molecules, supramolecular complexes, and systems (pathways and interaction networks) and the structural and functional effects caused by genetic variation, using approaches from bioinformatics, molecular modeling, and evolutionary sequence analysis. Its Principal Investigator is Prof. Jo\u00e3o Paulo MS Lima, Full Professor at UFRN. About me: Profissional I am a Biologist (Bachelor) graduated from the Federal University of Cear\u00e1 (UFC) (2000), Specialist in Bioinformatics (2002), Master (2003) and Doctor in Biochemistry (2007). My research formation included the areas of Biochemistry, Molecular Biology, and Bioinformatics. My main line of research today is the Evolution of Molecules and Metabolic Pathways, using approaches from Bioinformatics/Structural Bioinformatics and Molecular Phylogeny. I am currently a Full Professor of the Department of Biochemistry, Center for Biosciences of the Federal University of Rio Grande do Norte, permanent member of the Postgraduate Program in Bioinformatics (PPg-Bioinfo-IMD/UFRN), researcher (P.I.) of the Multiuser Bioinformatics Center (CMB/IMD/UFRN) and associate researcher of the Institute of Tropical Medicine of RN (IMT-RN). OrcID ResearchGate LinkedIN Personal Father of humans and dogs. Scientist, amateur cyclist (gravel enthusiast), and aspiring triathlete. Mastodon: @jpmslima@mstdn.science","title":"About Us"},{"location":"aboutus/#about-us","text":"","title":"About Us:"},{"location":"aboutus/#evomol-lab","text":"The Laboratory of Evolution of Molecules and Systems (EvoMol-Lab) is one of the research groups associated with the Bioinformatics Multidisciplinary Environment (BioME) , from the Digital Metropolis Institute (IMD) of the Federal University of Rio Grande do Norte ( UFRN ). EvoMol-Lab's mission is to study evolutionary processes that act on molecules, supramolecular complexes, and systems (pathways and interaction networks) and the structural and functional effects caused by genetic variation, using approaches from bioinformatics, molecular modeling, and evolutionary sequence analysis. Its Principal Investigator is Prof. Jo\u00e3o Paulo MS Lima, Full Professor at UFRN.","title":"EvoMol-Lab"},{"location":"aboutus/#about-me","text":"","title":"About me:"},{"location":"aboutus/#profissional","text":"I am a Biologist (Bachelor) graduated from the Federal University of Cear\u00e1 (UFC) (2000), Specialist in Bioinformatics (2002), Master (2003) and Doctor in Biochemistry (2007). My research formation included the areas of Biochemistry, Molecular Biology, and Bioinformatics. My main line of research today is the Evolution of Molecules and Metabolic Pathways, using approaches from Bioinformatics/Structural Bioinformatics and Molecular Phylogeny. I am currently a Full Professor of the Department of Biochemistry, Center for Biosciences of the Federal University of Rio Grande do Norte, permanent member of the Postgraduate Program in Bioinformatics (PPg-Bioinfo-IMD/UFRN), researcher (P.I.) of the Multiuser Bioinformatics Center (CMB/IMD/UFRN) and associate researcher of the Institute of Tropical Medicine of RN (IMT-RN). OrcID ResearchGate LinkedIN","title":"Profissional"},{"location":"aboutus/#personal","text":"Father of humans and dogs. Scientist, amateur cyclist (gravel enthusiast), and aspiring triathlete. Mastodon: @jpmslima@mstdn.science","title":"Personal"}]}